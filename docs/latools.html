

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>latools Documentation &mdash; latools 0.3.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="latools 0.3.1 documentation" href="index.html"/>
        <link rel="prev" title="The SRM file" href="users/advanced/srm-file.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> latools
          

          
          </a>

          
            
            
              <div class="version">
                0.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="users/index.html">User Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">latools Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-latools.latools">latools.analyse object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-latools.D_obj">latools.D object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filtering">Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-latools.helpers.helpers">Helpers</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">latools</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>latools Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/latools.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="latools-documentation">
<h1>latools Documentation<a class="headerlink" href="#latools-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-latools.latools">
<span id="latools-analyse-object"></span><h2>latools.analyse object<a class="headerlink" href="#module-latools.latools" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="latools.latools.analyse">
<em class="property">class </em><code class="descclassname">latools.latools.</code><code class="descname">analyse</code><span class="sig-paren">(</span><em>data_folder</em>, <em>errorhunt=False</em>, <em>config='DEFAULT'</em>, <em>dataformat=None</em>, <em>extension='.csv'</em>, <em>srm_identifier='STD'</em>, <em>cmap=None</em>, <em>time_format=None</em>, <em>internal_standard='Ca43'</em>, <em>names='file_names'</em>, <em>srm_file=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>For processing and analysing whole LA - ICPMS datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_folder</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The path to a directory containing multiple data files.</li>
<li><strong>errorhunt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, latools prints the name of each file before it
imports the data. This is useful for working out which
data file is causing the import to fail.</li>
<li><strong>config</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the configuration to use for the analysis.
This determines which configuration set from the
latools.cfg file is used, and overrides the default
configuration setup. You might sepcify this if your lab
routinely uses two different instruments.</li>
<li><strong>dataformat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Either a path to a data format file, or a
dataformat dict. See documentation for more details.</li>
<li><strong>extension</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The file extension of your data files. Defaults to
‘.csv’.</li>
<li><strong>srm_identifier</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A string used to separate samples and standards. srm_identifier
must be present in all standard measurements. Defaults to
‘STD’.</li>
<li><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dictionary of {analyte: colour} pairs. Colour can be any valid
matplotlib colour string, RGB or RGBA sequence, or hex string.</li>
<li><strong>time_format</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A regex string identifying the time format, used by pandas when
created a universal time scale. If unspecified (None), pandas
attempts to infer the time format, but in some cases this might
not work.</li>
<li><strong>internal_standard</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the analyte used as an internal standard throughout
analysis.</li>
<li><strong>names</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – <ul>
<li>‘file_names’ : use the file names as labels (default)</li>
<li>’metadata_names’ : used the ‘names’ attribute of metadata as the name
anything else : use numbers.</li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="latools.latools.analyse.folder">
<code class="descname">folder</code><a class="headerlink" href="#latools.latools.analyse.folder" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – Path to the directory containing the data files, as
specified by <cite>data_folder</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.dirname">
<code class="descname">dirname</code><a class="headerlink" href="#latools.latools.analyse.dirname" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – The name of the directory containing the data files,
without the entire path.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.files">
<code class="descname">files</code><a class="headerlink" href="#latools.latools.analyse.files" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array_like</em> – A list of all files in <cite>folder</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.param_dir">
<code class="descname">param_dir</code><a class="headerlink" href="#latools.latools.analyse.param_dir" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – The directory where parameters are stored.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.report_dir">
<code class="descname">report_dir</code><a class="headerlink" href="#latools.latools.analyse.report_dir" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – The directory where plots are saved.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.data">
<code class="descname">data</code><a class="headerlink" href="#latools.latools.analyse.data" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dict of <cite>latools.D</cite> data objects, labelled by sample
name.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.samples">
<code class="descname">samples</code><a class="headerlink" href="#latools.latools.analyse.samples" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array_like</em> – A list of samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.analytes">
<code class="descname">analytes</code><a class="headerlink" href="#latools.latools.analyse.analytes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array_like</em> – A list of analytes measured.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.stds">
<code class="descname">stds</code><a class="headerlink" href="#latools.latools.analyse.stds" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array_like</em> – A list of the <cite>latools.D</cite> objects containing hte SRM
data. These must contain srm_identifier in the file name.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.srm_identifier">
<code class="descname">srm_identifier</code><a class="headerlink" href="#latools.latools.analyse.srm_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – A string present in the file names of all standards.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyse.cmaps">
<code class="descname">cmaps</code><a class="headerlink" href="#latools.latools.analyse.cmaps" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – An analyte - specific colour map, used for plotting.</p>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.ablation_times">
<code class="descname">ablation_times</code><span class="sig-paren">(</span><em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.ablation_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.ablation_times" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.apply_classifier">
<code class="descname">apply_classifier</code><span class="sig-paren">(</span><em>name</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.apply_classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.apply_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a clustering classifier based on all samples, or a subset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the classifier to apply.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The subset of samples to apply the classifier to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>name</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.autorange">
<code class="descname">autorange</code><span class="sig-paren">(</span><em>analyte='total_counts', gwin=5, swin=3, win=20, on_mult=[1.0, 1.5], off_mult=[1.5, 1], nbin=10, transform='log', thresh_n=None, ploterrs=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.autorange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.autorange" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically separates signal and background data regions.</p>
<p>Automatically detect signal and background regions in the laser
data, based on the behaviour of a single analyte. The analyte used
should be abundant and homogenous in the sample.</p>
<p><strong>Step 1: Thresholding.</strong>
The background signal is determined using a gaussian kernel density
estimator (kde) of all the data. Under normal circumstances, this
kde should find two distinct data distributions, corresponding to
‘signal’ and ‘background’. The minima between these two distributions
is taken as a rough threshold to identify signal and background
regions. Any point where the trace crosses this thrshold is identified
as a ‘transition’.</p>
<p><strong>Step 2: Transition Removal.</strong>
The width of the transition regions between signal and background are
then determined, and the transitions are excluded from analysis. The
width of the transitions is determined by fitting a gaussian to the
smoothed first derivative of the analyte trace, and determining its
width at a point where the gaussian intensity is at at <cite>conf</cite> time the
gaussian maximum. These gaussians are fit to subsets of the data
centered around the transitions regions determined in Step 1, +/- <cite>win</cite>
data points. The peak is further isolated by finding the minima and
maxima of a second derivative within this window, and the gaussian is
fit to the isolated peak.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte that autorange should consider. For best results,
choose an analyte that is present homogeneously in high
concentrations.
This can also be ‘total_counts’ to use the sum of all analytes.</li>
<li><strong>gwin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The smoothing window used for calculating the first derivative.
Must be odd.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Determines the width (c +/- win) of the transition data subsets.</li>
<li><strong>smwin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The smoothing window used for calculating the second derivative.
Must be odd.</li>
<li><strong>conf</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The proportional intensity of the fitted gaussian tails that
determines the transition width cutoff (lower = wider transition
regions excluded).</li>
<li><strong>trans_mult</strong> (<em>array_like</em><em>, </em><em>len=2</em>) – Multiples of the peak FWHM to add to the transition cutoffs, e.g.
if the transitions consistently leave some bad data proceeding the
transition, set trans_mult to [0, 0.5] to ad 0.5 * the FWHM to the
right hand side of the limit.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Outputs added as instance attributes. Returns None.</em></li>
<li><strong>bkg, sig, trn</strong> (<em>iterable, bool</em>) – Boolean arrays identifying background, signal and transision
regions</li>
<li><strong>bkgrng, sigrng and trnrng</strong> (<em>iterable</em>) – (min, max) pairs identifying the boundaries of contiguous
True regions in the boolean arrays.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.basic_processing">
<code class="descname">basic_processing</code><span class="sig-paren">(</span><em>noise_despiker=True, despike_win=3, despike_nlim=12.0, despike_maxiter=4, autorange_analyte='total_counts', autorange_gwin=5, autorange_swin=3, autorange_win=20, autorange_on_mult=[1.0, 1.5], autorange_off_mult=[1.5, 1], autorange_nbin=10, autorange_transform='log', autorange_thresh_n=None, bkg_weight_fwhm=300.0, bkg_n_min=20, bkg_n_max=None, bkg_cstep=None, bkg_filter=False, bkg_f_win=7, bkg_f_n_lim=3, bkg_errtype='stderr', calib_drift_correct=True, calib_srms_used=['NIST610', 'NIST612', 'NIST614'], calib_zero_intercept=True, calib_n_min=10, plots=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.basic_processing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.basic_processing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.bkg_calc_interp1d">
<code class="descname">bkg_calc_interp1d</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>kind=1</em>, <em>n_min=10</em>, <em>n_max=None</em>, <em>cstep=None</em>, <em>bkg_filter=False</em>, <em>f_win=7</em>, <em>f_n_lim=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.bkg_calc_interp1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.bkg_calc_interp1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Background calculation using a 1D interpolation.</p>
<p>scipy.interpolate.interp1D is used for interpolation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which analyte or analytes to calculate.</li>
<li><strong>kind</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Integer specifying the order of the spline interpolation
used, or string specifying a type of interpolation.
Passed to <cite>scipy.interpolate.interp1D</cite></li>
<li><strong>n_min</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Background regions with fewer than n_min points
will not be included in the fit.</li>
<li><strong>cstep</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – The interval between calculated background points.</li>
<li><strong>filter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If true, apply a rolling filter to the isolated background regions
to exclude regions with anomalously high values. If True, two parameters
alter the filter’s behaviour:</li>
<li><strong>f_win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The size of the rolling window</li>
<li><strong>f_n_lim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The number of standard deviations above the rolling mean
to set the threshold.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.bkg_calc_weightedmean">
<code class="descname">bkg_calc_weightedmean</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>weight_fwhm=300.0</em>, <em>n_min=20</em>, <em>n_max=None</em>, <em>cstep=None</em>, <em>bkg_filter=False</em>, <em>f_win=7</em>, <em>f_n_lim=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.bkg_calc_weightedmean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.bkg_calc_weightedmean" title="Permalink to this definition">¶</a></dt>
<dd><p>Background calculation using a gaussian weighted mean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which analyte or analytes to calculate.</li>
<li><strong>weight_fwhm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The full-width-at-half-maximum of the gaussian used
to calculate the weighted average.</li>
<li><strong>n_min</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Background regions with fewer than n_min points
will not be included in the fit.</li>
<li><strong>cstep</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – The interval between calculated background points.</li>
<li><strong>filter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If true, apply a rolling filter to the isolated background regions
to exclude regions with anomalously high values. If True, two parameters
alter the filter’s behaviour:</li>
<li><strong>f_win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The size of the rolling window</li>
<li><strong>f_n_lim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The number of standard deviations above the rolling mean
to set the threshold.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.bkg_plot">
<code class="descname">bkg_plot</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>figsize=None</em>, <em>yscale='log'</em>, <em>ylim=None</em>, <em>err='stderr'</em>, <em>save=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.bkg_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.bkg_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the calculated background.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which analyte(s) to plot.</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – The (width, height) of the figure, in inches.
If None, calculated based on number of samples.</li>
<li><strong>yscale</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘log’ (default) or ‘linear’.</li>
<li><strong>ylim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – Manually specify the y scale.</li>
<li><strong>err</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – What type of error to plot. Default is stderr.</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, figure is saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fig, ax</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">matplotlib.figure, matplotlib.axes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.bkg_subtract">
<code class="descname">bkg_subtract</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>errtype='stderr'</em>, <em>focus='despiked'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.bkg_subtract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.bkg_subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract calculated background from data.</p>
<p>Must run bkg_calc first!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which analyte(s) to subtract.</li>
<li><strong>errtype</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Which type of error to propagate. default is ‘stderr’.</li>
<li><strong>focus</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Which stage of analysis to work on. Change to ‘rawdata’ if
you’re skipping the despiking step.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.calibrate">
<code class="descname">calibrate</code><span class="sig-paren">(</span><em>analytes=None, drift_correct=True, srms_used=['NIST610', 'NIST612', 'NIST614'], zero_intercept=True, n_min=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.calibrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.calibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibrates the data to measured SRM values.</p>
<p>Assumes that y intercept is zero.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which analytes you’d like to calibrate. Defaults to all.</li>
<li><strong>drift_correct</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to pool all SRM measurements into a single calibration,
or vary the calibration through the run, interpolating
coefficients between measured SRMs.</li>
<li><strong>srms_used</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which SRMs have been measured. Must match names given in
SRM data file <em>exactly</em>.</li>
<li><strong>n_min</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of data points an SRM measurement
must have to be included.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.calibration_plot">
<code class="descname">calibration_plot</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>datarange=True</em>, <em>loglog=False</em>, <em>save=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.calibration_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.calibration_plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.clear_calibration">
<code class="descname">clear_calibration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.clear_calibration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.clear_calibration" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.crossplot">
<code class="descname">crossplot</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>lognorm=True</em>, <em>bins=25</em>, <em>filt=False</em>, <em>samples=None</em>, <em>subset=None</em>, <em>figsize=(12</em>, <em>12)</em>, <em>save=False</em>, <em>colourful=True</em>, <em>mode='hist2d'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.crossplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.crossplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes against each other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>lognorm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to log normalise the colour scale
of the 2D histogram.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of bins in the 2D histogram.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – Figure size (width, height) in inches.</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – If True, plot is saves as ‘crossplot.png’, if str plot is
saves as str.</li>
<li><strong>colourful</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not the plot should be colourful :).</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘hist2d’ (default) or ‘scatter’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.crossplot_filters">
<code class="descname">crossplot_filters</code><span class="sig-paren">(</span><em>filter_string</em>, <em>analytes=None</em>, <em>samples=None</em>, <em>subset=None</em>, <em>filt=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.crossplot_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.crossplot_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the results of a group of filters in a crossplot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filter_string</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A string that identifies a group of filters.
e.g. ‘test’ would plot all filters with ‘test’ in the
name.</li>
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">fig, axes objects</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.despike">
<code class="descname">despike</code><span class="sig-paren">(</span><em>expdecay_despiker=False</em>, <em>exponent=None</em>, <em>tstep=None</em>, <em>noise_despiker=True</em>, <em>win=3</em>, <em>nlim=12.0</em>, <em>exponentplot=False</em>, <em>maxiter=4</em>, <em>autorange_kwargs={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.despike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.despike" title="Permalink to this definition">¶</a></dt>
<dd><p>Despikes data with exponential decay and noise filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>expdecay_despiker</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply the exponential decay filter.</li>
<li><strong>exponent</strong> (<a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The exponent for the exponential decay filter. If None,
it is determined automatically using <cite>find_expocoef</cite>.</li>
<li><strong>tstep</strong> (<a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The timeinterval between measurements. If None, it is
determined automatically from the Time variable.</li>
<li><strong>noise_despiker</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply the standard deviation spike filter.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The rolling window over which the spike filter calculates
the trace statistics.</li>
<li><strong>nlim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The number of standard deviations above the rolling mean
that data are excluded.</li>
<li><strong>exponentplot</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to show a plot of the automatically determined
exponential decay exponent.</li>
<li><strong>maxiter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The max number of times that the fitler is applied.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.export_traces">
<code class="descname">export_traces</code><span class="sig-paren">(</span><em>outdir=None</em>, <em>focus_stage=None</em>, <em>analytes=None</em>, <em>samples=None</em>, <em>subset='All_Analyses'</em>, <em>filt=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.export_traces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.export_traces" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to export raw data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>outdir</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – directory to save toe traces. Defaults to ‘main-dir-name_export’.</li>
<li><strong>focus_stage</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – <p>The name of the analysis stage to export.</p>
<ul>
<li>’rawdata’: raw data, loaded from csv file.</li>
<li>’despiked’: despiked data.</li>
<li>’signal’/’background’: isolated signal and background data.
Created by self.separate, after signal and background
regions have been identified by self.autorange.</li>
<li>’bkgsub’: background subtracted data, created by
self.bkg_correct</li>
<li>’ratios’: element ratio data, created by self.ratio.</li>
<li>’calibrated’: ratio data calibrated to standards, created by self.calibrate.</li>
</ul>
<p>Defaults to the most recent stage of analysis.</p>
</li>
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array - like</em>) – Either a single analyte, or list of analytes to export.
Defaults to all analytes.</li>
<li><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array - like</em>) – Either a single sample name, or list of samples to export.
Defaults to all samples.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_clear">
<code class="descname">filter_clear</code><span class="sig-paren">(</span><em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears (deletes) all data filters.</p>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_clustering">
<code class="descname">filter_clustering</code><span class="sig-paren">(</span><em>analytes</em>, <em>filt=False</em>, <em>normalise=True</em>, <em>method='meanshift'</em>, <em>include_time=False</em>, <em>samples=None</em>, <em>sort=True</em>, <em>subset=None</em>, <em>min_data=10</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_clustering"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies an n - dimensional clustering filter to the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) that the filter applies to.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
<li><strong>normalise</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to normalise the data to zero mean and unit
variance. Reccomended if clustering based on more than 1 analyte.
Uses <cite>sklearn.preprocessing.scale</cite>.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – <p>Which clustering algorithm to use:</p>
<ul>
<li>’meanshift’: The <cite>sklearn.cluster.MeanShift</cite> algorithm.
Automatically determines number of clusters
in data based on the <cite>bandwidth</cite> of expected
variation.</li>
<li>’kmeans’: The <cite>sklearn.cluster.KMeans</cite> algorithm. Determines
the characteristics of a known number of clusters
within the data. Must provide <cite>n_clusters</cite> to specify
the expected number of clusters.</li>
<li>’DBSCAN’: The <cite>sklearn.cluster.DBSCAN</cite> algorithm. Automatically
determines the number and characteristics of clusters
within the data based on the ‘connectivity’ of the
data (i.e. how far apart each data point is in a
multi - dimensional parameter space). Requires you to
set <cite>eps</cite>, the minimum distance point must be from
another point to be considered in the same cluster,
and <cite>min_samples</cite>, the minimum number of points that
must be within the minimum distance for it to be
considered a cluster. It may also be run in automatic
mode by specifying <cite>n_clusters</cite> alongside
<cite>min_samples</cite>, where eps is decreased until the
desired number of clusters is obtained.</li>
</ul>
</li>
<li><strong>include_time</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to include the Time variable in the clustering
analysis. Useful if you’re looking for spatially continuous
clusters in your data, i.e. this will identify each spot in your
analysis as an individual cluster.</li>
<li><strong>samples</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – Which samples to apply this filter to. If None, applies to all
samples.</li>
<li><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not you want the cluster labels to
be sorted by the mean magnitude of the signals
they are based on (0 = lowest)</li>
<li><strong>min_data</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of data points that should be considered by
the filter. Default = 10.</li>
<li><strong>**kwargs</strong> – Parameters passed to the clustering algorithm specified by
<cite>method</cite>.</li>
<li><strong>Parameters</strong> (<em>DBSCAN</em>) – <dl class="docutils">
<dt>bandwidth <span class="classifier-delimiter">:</span> <span class="classifier">str or float</span></dt>
<dd>The bandwith (float) or bandwidth method (‘scott’ or ‘silverman’)
used to estimate the data bandwidth.</dd>
<dt>bin_seeding <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>Modifies the behaviour of the meanshift algorithm. Refer to
sklearn.cluster.meanshift documentation.</dd>
</dl>
</li>
<li><strong>- Means Parameters</strong> (<em>K</em>) – <dl class="docutils">
<dt>n_clusters <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The number of clusters expected in the data.</dd>
</dl>
</li>
<li><strong>Parameters</strong> – <dl class="docutils">
<dt>eps <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The minimum ‘distance’ points must be apart for them to be in the
same cluster. Defaults to 0.3. Note: If the data are normalised
(they should be for DBSCAN) this is in terms of total sample
variance. Normalised data have a mean of 0 and a variance of 1.</dd>
<dt>min_samples <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The minimum number of samples within distance <cite>eps</cite> required
to be considered as an independent cluster.</dd>
<dt>n_clusters <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The number of clusters expected. If specified, <cite>eps</cite> will be
incrementally reduced until the expected number of clusters is
found.</dd>
<dt>maxiter <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The maximum number of iterations DBSCAN will run.</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_correlation">
<code class="descname">filter_correlation</code><span class="sig-paren">(</span><em>x_analyte</em>, <em>y_analyte</em>, <em>window=None</em>, <em>r_threshold=0.9</em>, <em>p_threshold=0.05</em>, <em>filt=True</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_correlation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a correlation filter to the data.</p>
<p>Calculates a rolling correlation between every <cite>window</cite> points of
two analytes, and excludes data where their Pearson’s R value is
above <cite>r_threshold</cite> and statistically significant.</p>
<p>Data will be excluded where their absolute R value is greater than
<cite>r_threshold</cite> AND the p - value associated with the correlation is
less than <cite>p_threshold</cite>. i.e. only correlations that are statistically
significant are considered.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_analyte</strong> (<em>x_analyte</em><em>,</em>) – The names of the x and y analytes to correlate.</li>
<li><strong>window</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – The rolling window used when calculating the correlation.</li>
<li><strong>r_threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The correlation index above which to exclude data.
Note: the absolute pearson R value is considered, so
negative correlations below -<cite>r_threshold</cite> will also
be excluded.</li>
<li><strong>p_threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The significant level below which data are excluded.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_defragment">
<code class="descname">filter_defragment</code><span class="sig-paren">(</span><em>threshold</em>, <em>mode='include'</em>, <em>filt=True</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_defragment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_defragment" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove ‘fragments’ from the calculated filter</p>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_effect">
<code class="descname">filter_effect</code><span class="sig-paren">(</span><em>analytes=None, stats=['mean', 'std'], filt=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_effect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_effect" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantify the effects of the active filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>list</em>) – Which analytes to consider.</li>
<li><strong>stats</strong> (<em>list</em>) – Which statistics to calculate.</li>
<li><strong>file</strong> (<em>valid filter string</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Which filter to consider. If True, applies all
active filters.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Contains statistics calculated for filtered and
unfiltered data, and the filtered/unfiltered ratio.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_exclude_downhole">
<code class="descname">filter_exclude_downhole</code><span class="sig-paren">(</span><em>threshold</em>, <em>filt=True</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_exclude_downhole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_exclude_downhole" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude all points down-hole (after) the first excluded data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>threhold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of contiguous excluded data points
that must exist before downhole exclusion occurs.</li>
<li><strong>file</strong> (<em>valid filter string</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Which filter to consider. If True, applies to currently active
filters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_gradient_threshold">
<code class="descname">filter_gradient_threshold</code><span class="sig-paren">(</span><em>analyte</em>, <em>threshold</em>, <em>win=15</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_gradient_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_gradient_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a gradient threshold filter to the data.</p>
<p>Generates two filters above and below the threshold value for a
given analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte that the filter applies to.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window over which to calculate the moving gradient</li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The threshold value.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
<li><strong>samples</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – Which samples to apply this filter to. If None, applies to all
samples.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>number</em>) – The subset of samples (defined by make_subset) you want to apply
the filter to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_gradient_threshold_percentile">
<code class="descname">filter_gradient_threshold_percentile</code><span class="sig-paren">(</span><em>analyte</em>, <em>percentiles</em>, <em>level='population'</em>, <em>win=15</em>, <em>filt=False</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_gradient_threshold_percentile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_gradient_threshold_percentile" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a gradient threshold filter to the data.</p>
<p>Generates two filters above and below the threshold value for a
given analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte that the filter applies to.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window over which to calculate the moving gradient</li>
<li><strong>percentiles</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>iterable of len=2</em>) – The percentile values.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
<li><strong>samples</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – Which samples to apply this filter to. If None, applies to all
samples.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>number</em>) – The subset of samples (defined by make_subset) you want to apply
the filter to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_nremoved">
<code class="descname">filter_nremoved</code><span class="sig-paren">(</span><em>filt=True</em>, <em>quiet=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_nremoved"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_nremoved" title="Permalink to this definition">¶</a></dt>
<dd><p>Report how many data are removed by the active filters.</p>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_off">
<code class="descname">filter_off</code><span class="sig-paren">(</span><em>filt=None</em>, <em>analyte=None</em>, <em>samples=None</em>, <em>subset=None</em>, <em>show_status=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_off"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_off" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns data filters off for particular analytes and samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filt</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name, partial name or list of names of filters. Supports
partial matching. i.e. if ‘cluster’ is specified, all
filters with ‘cluster’ in the name are activated.
Defaults to all filters.</li>
<li><strong>analyte</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name or list of names of analytes. Defaults to all analytes.</li>
<li><strong>samples</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – Which samples to apply this filter to. If None, applies to all
samples.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_on">
<code class="descname">filter_on</code><span class="sig-paren">(</span><em>filt=None</em>, <em>analyte=None</em>, <em>samples=None</em>, <em>subset=None</em>, <em>show_status=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_on"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns data filters on for particular analytes and samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filt</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name, partial name or list of names of filters. Supports
partial matching. i.e. if ‘cluster’ is specified, all
filters with ‘cluster’ in the name are activated.
Defaults to all filters.</li>
<li><strong>analyte</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name or list of names of analytes. Defaults to all analytes.</li>
<li><strong>samples</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – Which samples to apply this filter to. If None, applies to all
samples.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_reports">
<code class="descname">filter_reports</code><span class="sig-paren">(</span><em>analytes</em>, <em>filt_str='all'</em>, <em>nbin=5</em>, <em>samples=None</em>, <em>outdir=None</em>, <em>subset='All_Samples'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_reports"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_reports" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot filter reports for all filters that contain <code class="docutils literal"><span class="pre">filt_str</span></code>
in the name.</p>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_status">
<code class="descname">filter_status</code><span class="sig-paren">(</span><em>sample=None</em>, <em>subset=None</em>, <em>stds=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the current status of filters for specified samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sample</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Which sample to print.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Specify a subset</li>
<li><strong>stds</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to include standards.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_threshold">
<code class="descname">filter_threshold</code><span class="sig-paren">(</span><em>analyte</em>, <em>threshold</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a threshold filter to the data.</p>
<p>Generates two filters above and below the threshold value for a
given analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte that the filter applies to.</li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The threshold value.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
<li><strong>samples</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – Which samples to apply this filter to. If None, applies to all
samples.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>number</em>) – The subset of samples (defined by make_subset) you want to apply
the filter to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_threshold_percentile">
<code class="descname">filter_threshold_percentile</code><span class="sig-paren">(</span><em>analyte</em>, <em>percentiles</em>, <em>level='population'</em>, <em>filt=False</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_threshold_percentile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_threshold_percentile" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a threshold filter to the data.</p>
<p>Generates two filters above and below the threshold value for a
given analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte that the filter applies to.</li>
<li><strong>percentiles</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>iterable of len=2</em>) – The percentile values.</li>
<li><strong>level</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Whether to calculate percentiles from the entire dataset
(‘population’) or for each individual sample (‘individual’)</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
<li><strong>samples</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – Which samples to apply this filter to. If None, applies to all
samples.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>number</em>) – The subset of samples (defined by make_subset) you want to apply
the filter to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.filter_trim">
<code class="descname">filter_trim</code><span class="sig-paren">(</span><em>start=1</em>, <em>end=1</em>, <em>filt=True</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.filter_trim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.filter_trim" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove points from the start and end of filter regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>end</strong> (<em>start</em><em>,</em>) – The number of points to remove from the start and end of
the specified filter.</li>
<li><strong>filt</strong> (<em>valid filter string</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Which filter to trim. If True, applies to currently active
filters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.find_expcoef">
<code class="descname">find_expcoef</code><span class="sig-paren">(</span><em>nsd_below=0.0</em>, <em>analyte=None</em>, <em>plot=False</em>, <em>trimlim=None</em>, <em>autorange_kwargs={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.find_expcoef"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.find_expcoef" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines exponential decay coefficient for despike filter.</p>
<p>Fits an exponential decay function to the washout phase of standards
to determine the washout time of your laser cell. The exponential
coefficient reported is <cite>nsd_below</cite> standard deviations below the
fitted exponent, to ensure that no real data is removed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nsd_below</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The number of standard deviations to subtract from the fitted
coefficient when calculating the filter exponent.</li>
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte to consider when determining the coefficient.
Use high - concentration analyte for best estimates.</li>
<li><strong>plot</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – If True, creates a plot of the fit, if str the plot is to the
location specified in str.</li>
<li><strong>trimlim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – A threshold limit used in determining the start of the
exponential decay region of the washout. Defaults to half
the increase in signal over background. If the data in
the plot don’t fall on an exponential decay line, change
this number. Normally you’ll need to increase it.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.fit_classifier">
<code class="descname">fit_classifier</code><span class="sig-paren">(</span><em>name</em>, <em>analytes</em>, <em>method</em>, <em>samples=None</em>, <em>subset=None</em>, <em>filt=True</em>, <em>sort_by=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.fit_classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.fit_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a clustering classifier based on all samples, or a subset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the classifier.</li>
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which analytes the clustering algorithm should consider.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – <p>Which clustering algorithm to use. Can be:</p>
<dl class="docutils">
<dt>’meanshift’</dt>
<dd>The <cite>sklearn.cluster.MeanShift</cite> algorithm.
Automatically determines number of clusters
in data based on the <cite>bandwidth</cite> of expected
variation.</dd>
<dt>’kmeans’</dt>
<dd>The <cite>sklearn.cluster.KMeans</cite> algorithm. Determines
the characteristics of a known number of clusters
within the data. Must provide <cite>n_clusters</cite> to specify
the expected number of clusters.</dd>
</dl>
</li>
<li><strong>samples</strong> (<em>iterable</em>) – list of samples to consider. Overrides ‘subset’.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The subset of samples used to fit the classifier. Ignored if
‘samples’ is specified.</li>
<li><strong>sort_by</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Which analyte the resulting clusters should be sorted
by - defaults to 0, which is the first analyte.</li>
<li><strong>**kwargs</strong> – method-specific keyword parameters - see below.</li>
<li><strong>Parameters</strong> (<em>Meanshift</em>) – <dl class="docutils">
<dt>bandwidth <span class="classifier-delimiter">:</span> <span class="classifier">str or float</span></dt>
<dd>The bandwith (float) or bandwidth method (‘scott’ or ‘silverman’)
used to estimate the data bandwidth.</dd>
<dt>bin_seeding <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd>Modifies the behaviour of the meanshift algorithm. Refer to
sklearn.cluster.meanshift documentation.</dd>
</dl>
</li>
<li><strong>- Means Parameters</strong> (<em>K</em>) – <dl class="docutils">
<dt>n_clusters <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The number of clusters expected in the data.</dd>
</dl>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>name</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.get_background">
<code class="descname">get_background</code><span class="sig-paren">(</span><em>n_min=10</em>, <em>n_max=None</em>, <em>focus_stage='despiked'</em>, <em>bkg_filter=False</em>, <em>f_win=5</em>, <em>f_n_lim=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.get_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.get_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract all background data from all samples on universal time scale.
Used by both ‘polynomial’ and ‘weightedmean’ methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_min</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of points a background region must
have to be included in calculation.</li>
<li><strong>n_max</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The maximum number of points a background region must
have to be included in calculation.</li>
<li><strong>filter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If true, apply a rolling filter to the isolated background regions
to exclude regions with anomalously high values. If True, two parameters
alter the filter’s behaviour:</li>
<li><strong>f_win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The size of the rolling window</li>
<li><strong>f_n_lim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The number of standard deviations above the rolling mean
to set the threshold.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame object containing background data.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.get_focus">
<code class="descname">get_focus</code><span class="sig-paren">(</span><em>filt=False</em>, <em>samples=None</em>, <em>subset=None</em>, <em>nominal=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.get_focus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.get_focus" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect all data from all samples into a single array.
Data from standards is not collected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>list</em>) – which samples to get</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – which subset to get</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.get_gradients">
<code class="descname">get_gradients</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>win=15</em>, <em>filt=False</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.get_gradients"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.get_gradients" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect all data from all samples into a single array.
Data from standards is not collected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>list</em>) – which samples to get</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – which subset to get</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.getstats">
<code class="descname">getstats</code><span class="sig-paren">(</span><em>save=True</em>, <em>filename=None</em>, <em>samples=None</em>, <em>subset=None</em>, <em>ablation_time=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.getstats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.getstats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pandas dataframe of all sample statistics.</p>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.gradient_crossplot">
<code class="descname">gradient_crossplot</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>win=15</em>, <em>lognorm=True</em>, <em>bins=25</em>, <em>filt=False</em>, <em>samples=None</em>, <em>subset=None</em>, <em>figsize=(12</em>, <em>12)</em>, <em>save=False</em>, <em>colourful=True</em>, <em>mode='hist2d'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.gradient_crossplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.gradient_crossplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analyte gradients against each other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>lognorm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to log normalise the colour scale
of the 2D histogram.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of bins in the 2D histogram.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – Figure size (width, height) in inches.</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – If True, plot is saves as ‘crossplot.png’, if str plot is
saves as str.</li>
<li><strong>colourful</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not the plot should be colourful :).</li>
<li><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – ‘hist2d’ (default) or ‘scatter’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.gradient_histogram">
<code class="descname">gradient_histogram</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>win=15</em>, <em>filt=False</em>, <em>bins=None</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.gradient_histogram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.gradient_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a histogram of the gradients in all samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a><em> or </em><em>array-like</em>) – The bins to use in the histogram</li>
<li><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>list</em>) – which samples to get</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – which subset to get</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">fig, ax</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.gradient_plots">
<code class="descname">gradient_plots</code><span class="sig-paren">(</span><em>analytes=None, win=15, samples=None, ranges=False, focus=None, outdir=None, figsize=[10, 4], subset='All_Analyses'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.gradient_plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.gradient_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analyte gradients as a function of time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>samples</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The sample(s) to plot. Defaults to all samples.</li>
<li><strong>ranges</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to show the signal/backgroudn regions
identified by ‘autorange’.</li>
<li><strong>focus</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The focus ‘stage’ of the analysis to plot. Can be
‘rawdata’, ‘despiked’:, ‘signal’, ‘background’,
‘bkgsub’, ‘ratios’ or ‘calibrated’.</li>
<li><strong>outdir</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to a directory where you’d like the plots to be
saved. Defaults to ‘reports/[focus]’ in your data directory.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – If ‘log’, plots the data on a log scale.</li>
<li><strong>figsize</strong> (<em>array_like</em>) – Array of length 2 specifying figure [width, height] in
inches.</li>
<li><strong>stats</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to overlay the mean and standard deviations
for each trace.</li>
<li><strong>err</strong> (<a class="reference external" href="https://docs.python.org/2/library/stat.html#module-stat" title="(in Python v2.7)"><em>stat</em></a><em>,</em>) – The names of the statistic and error components to plot.
Deafaults to ‘nanmean’ and ‘nanstd’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.histograms">
<code class="descname">histograms</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>bins=25</em>, <em>logy=False</em>, <em>filt=False</em>, <em>colourful=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.histograms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.histograms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot histograms of analytes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of bins in each histogram (default = 25)</li>
<li><strong>logy</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If true, y axis is a log scale.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>colourful</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If True, histograms are colourful :)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.make_subset">
<code class="descname">make_subset</code><span class="sig-paren">(</span><em>samples=None</em>, <em>name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.make_subset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.make_subset" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a subset of samples, which can be treated independently.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array - like</em>) – Name of sample, or list of sample names.</li>
<li><strong>name</strong> (<em>(</em><em>optional</em><em>) </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>number</em>) – The name of the sample group. Defaults to n + 1, where n is
the highest existing group number</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.minimal_export">
<code class="descname">minimal_export</code><span class="sig-paren">(</span><em>target_analytes=None</em>, <em>override=False</em>, <em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.minimal_export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.minimal_export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports a analysis parameters, standard info and a minimal dataset,
which can be imported by another user.</p>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.optimisation_plots">
<code class="descname">optimisation_plots</code><span class="sig-paren">(</span><em>overlay_alpha=0.5</em>, <em>samples=None</em>, <em>subset=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.optimisation_plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.optimisation_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the result of signal_optimise.</p>
<p><cite>signal_optimiser</cite> must be run first, and the output
stored in the <cite>opt</cite> attribute of the latools.D object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>d</strong> (<em>latools.D object</em>) – A latools data object.</li>
<li><strong>overlay_alpha</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The opacity of the threshold overlays. Between 0 and 1.</li>
<li><strong>**kwargs</strong> – Passed to <cite>tplot</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.optimise_signal">
<code class="descname">optimise_signal</code><span class="sig-paren">(</span><em>analytes</em>, <em>min_points=5</em>, <em>threshold_mode='kde_first_max'</em>, <em>threshold_mult=1.0</em>, <em>x_bias=0</em>, <em>filt=True</em>, <em>weights=None</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.optimise_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.optimise_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimise data selection based on specified analytes.</p>
<p>Identifies the longest possible contiguous data region in
the signal where the relative standard deviation (std) and
concentration of all analytes is minimised.</p>
<p>Optimisation is performed via a grid search of all possible
contiguous data regions. For each region, the mean std and
mean scaled analyte concentration (‘amplitude’) are calculated.</p>
<p>The size and position of the optimal data region are identified
using threshold std and amplitude values. Thresholds are derived
from all calculated stds and amplitudes using the method specified
by <cite>threshold_mode</cite>. For example, using the ‘kde_max’ method, a
probability density function (PDF) is calculated for std and
amplitude values, and the threshold is set as the maximum of the
PDF. These thresholds are then used to identify the size and position
of the longest contiguous region where the std is below the threshold,
and the amplitude is either below the threshold.</p>
<p>All possible regions of the data that have at least
<cite>min_points</cite> are considered.</p>
<p>For a graphical demonstration of the action of signal_optimiser,
use <cite>optimisation_plot</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>d</strong> (<em>latools.D object</em>) – An latools data object.</li>
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array-like</em>) – Which analytes to consider.</li>
<li><strong>min_points</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of contiguous points to
consider.</li>
<li><strong>threshold_mode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The method used to calculate the optimisation
thresholds. Can be ‘mean’, ‘median’, ‘kde_max’
or ‘bayes_mvs’, or a custom function. If a
function, must take a 1D array, and return a
single, real number.</li>
<li><strong>weights</strong> (<em>array-like of length len</em><em>(</em><a class="reference internal" href="#latools.latools.analyse.analytes" title="latools.latools.analyse.analytes"><em>analytes</em></a><em>)</em>) – An array of numbers specifying the importance of
each analyte considered. Larger number makes the
analyte have a greater effect on the optimisation.
Default is None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.ratio">
<code class="descname">ratio</code><span class="sig-paren">(</span><em>internal_standard=None</em>, <em>focus='bkgsub'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the ratio of all analytes to a single analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>internal_standard</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the analyte to divide all other analytes
by.</li>
<li><strong>focus</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The <cite>focus</cite> stage of the data used to calculating the
ratios.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.sample_stats">
<code class="descname">sample_stats</code><span class="sig-paren">(</span><em>analytes=None, filt=True, stats=['mean', 'std'], eachtrace=True, csf_dict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.sample_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.sample_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate sample statistics.</p>
<p>Returns samples, analytes, and arrays of statistics
of shape (samples, analytes). Statistics are calculated
from the ‘focus’ data variable, so output depends on how
the data have been processed.</p>
<p>Included stat functions:</p>
<ul class="simple">
<li><code class="xref py py-func docutils literal"><span class="pre">mean()</span></code>: arithmetic mean</li>
<li><code class="xref py py-func docutils literal"><span class="pre">std()</span></code>: arithmetic standard deviation</li>
<li><code class="xref py py-func docutils literal"><span class="pre">se()</span></code>: arithmetic standard error</li>
<li><code class="xref py py-func docutils literal"><span class="pre">H15_mean()</span></code>: Huber mean (outlier removal)</li>
<li><code class="xref py py-func docutils literal"><span class="pre">H15_std()</span></code>: Huber standard deviation (outlier removal)</li>
<li><code class="xref py py-func docutils literal"><span class="pre">H15_se()</span></code>: Huber standard error (outlier removal)</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to calculate statistics for. Defaults to
all analytes.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>stats</strong> (<em>array_like</em>) – take a single array_like input, and return a single statistic.
list of functions or names (see above) or functions that
Function should be able to cope with NaN values.</li>
<li><strong>eachtrace</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether to calculate the statistics for each analysis
spot individually, or to produce per - sample means.
Default is True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Adds dict to analyse object containing samples, analytes and
functions and data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.set_focus">
<code class="descname">set_focus</code><span class="sig-paren">(</span><em>focus_stage=None</em>, <em>samples=None</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.set_focus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.set_focus" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the ‘focus’ attribute of the data file.</p>
<p>The ‘focus’ attribute of the object points towards data from a
particular stage of analysis. It is used to identify the ‘working
stage’ of the data. Processing functions operate on the ‘focus’
stage, so if steps are done out of sequence, things will break.</p>
<p>Names of analysis stages:</p>
<ul class="simple">
<li>‘rawdata’: raw data, loaded from csv file when object
is initialised.</li>
<li>‘despiked’: despiked data.</li>
<li>‘signal’/’background’: isolated signal and background data,
padded with np.nan. Created by self.separate, after
signal and background regions have been identified by
self.autorange.</li>
<li>‘bkgsub’: background subtracted data, created by
self.bkg_correct</li>
<li>‘ratios’: element ratio data, created by self.ratio.</li>
<li>‘calibrated’: ratio data calibrated to standards, created by
self.calibrate.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>focus</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the analysis stage desired.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.srm_id_auto">
<code class="descname">srm_id_auto</code><span class="sig-paren">(</span><em>srms_used=['NIST610', 'NIST612', 'NIST614'], n_min=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.srm_id_auto"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.srm_id_auto" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for automarically identifying SRMs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>srms_used</strong> (<em>iterable</em>) – Which SRMs have been used. Must match SRM names
in SRM database <em>exactly</em> (case sensitive!).</li>
<li><strong>n_min</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of data points a SRM measurement
must contain to be included.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.statplot">
<code class="descname">statplot</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>samples=None</em>, <em>figsize=None</em>, <em>stat='mean'</em>, <em>err='std'</em>, <em>subset=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.statplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.statplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for visualising per-ablation and per-sample means.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which analyte(s) to plot</li>
<li><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>iterable</em>) – Which sample(s) to plot</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – Figure (width, height) in inches</li>
<li><strong>stat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Which statistic to plot. Must match
the name of the functions used in
‘sample_stats’.</li>
<li><strong>err</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Which uncertainty to plot.</li>
<li><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Which subset of samples to plot.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.trace_plots">
<code class="descname">trace_plots</code><span class="sig-paren">(</span><em>analytes=None, samples=None, ranges=False, focus=None, outdir=None, filt=None, scale='log', figsize=[10, 4], stats=False, stat='nanmean', err='nanstd', subset='All_Analyses'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.trace_plots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.trace_plots" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes as a function of time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>samples</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The sample(s) to plot. Defaults to all samples.</li>
<li><strong>ranges</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to show the signal/backgroudn regions
identified by ‘autorange’.</li>
<li><strong>focus</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The focus ‘stage’ of the analysis to plot. Can be
‘rawdata’, ‘despiked’:, ‘signal’, ‘background’,
‘bkgsub’, ‘ratios’ or ‘calibrated’.</li>
<li><strong>outdir</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to a directory where you’d like the plots to be
saved. Defaults to ‘reports/[focus]’ in your data directory.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – If ‘log’, plots the data on a log scale.</li>
<li><strong>figsize</strong> (<em>array_like</em>) – Array of length 2 specifying figure [width, height] in
inches.</li>
<li><strong>stats</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to overlay the mean and standard deviations
for each trace.</li>
<li><strong>err</strong> (<a class="reference external" href="https://docs.python.org/2/library/stat.html#module-stat" title="(in Python v2.7)"><em>stat</em></a><em>,</em>) – The names of the statistic and error components to plot.
Deafaults to ‘nanmean’ and ‘nanstd’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.latools.analyse.zeroscreen">
<code class="descname">zeroscreen</code><span class="sig-paren">(</span><em>focus_stage=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#analyse.zeroscreen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.analyse.zeroscreen" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all points containing data below zero (which are impossible!)</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="latools.latools.analyze">
<code class="descclassname">latools.latools.</code><code class="descname">analyze</code><a class="headerlink" href="#latools.latools.analyze" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#latools.latools.analyse" title="latools.latools.analyse"><code class="xref py py-class docutils literal"><span class="pre">analyse</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="latools.latools.reproduce">
<code class="descclassname">latools.latools.</code><code class="descname">reproduce</code><span class="sig-paren">(</span><em>log_file</em>, <em>plotting=False</em>, <em>data_folder=None</em>, <em>srm_table=None</em>, <em>custom_stat_functions=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/latools.html#reproduce"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.latools.reproduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reproduce a previous analysis exported with <code class="xref py py-func docutils literal"><span class="pre">latools.analyse.minimal_export()</span></code></p>
<p>For normal use, supplying <cite>log_file</cite> and specifying a plotting option should be
enough to reproduce an analysis. All requisites (raw data, SRM table and any
custom stat functions) will then be imported from the minimal_export folder.</p>
<p>You may also specify your own raw_data, srm_table and custom_stat_functions,
if you wish.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>log_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The path to the log file produced by <code class="xref py py-func docutils literal"><span class="pre">minimal_export()</span></code>.</li>
<li><strong>plotting</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to output plots.</li>
<li><strong>data_folder</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Optional. Specify a different data folder. Data folder
should normally be in the same folder as the log file.</li>
<li><strong>srm_table</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Optional. Specify a different SRM table. SRM table
should normally be in the same folder as the log file.</li>
<li><strong>custom_stat_functions</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Optional. Specify a python file containing custom
stat functions for use by reproduce. Any custom
stat functions should normally be included in the
same folder as the log file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-latools.D_obj">
<span id="latools-d-object"></span><h2>latools.D object<a class="headerlink" href="#module-latools.D_obj" title="Permalink to this headline">¶</a></h2>
<p>The Data object, used to contain single laser ablation data files.</p>
<dl class="class">
<dt id="latools.D_obj.D">
<em class="property">class </em><code class="descclassname">latools.D_obj.</code><code class="descname">D</code><span class="sig-paren">(</span><em>data_file</em>, <em>dataformat=None</em>, <em>errorhunt=False</em>, <em>cmap=None</em>, <em>internal_standard='Ca43'</em>, <em>name='file_names'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Container for data from a single laser ablation analysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The path to a data file.</li>
<li><strong>errorhunt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to print each data file name before
import. This is useful for tracing which data file
is causing the import to fail.</li>
<li><strong>dataformat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Either a path to a data format file, or a
dataformat dict. See documentation for more details.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="latools.D_obj.D.sample">
<code class="descname">sample</code><a class="headerlink" href="#latools.D_obj.D.sample" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – Sample name.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.meta">
<code class="descname">meta</code><a class="headerlink" href="#latools.D_obj.D.meta" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – Metadata extracted from the csv header. Contents varies,
depending on your <cite>dataformat</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.analytes">
<code class="descname">analytes</code><a class="headerlink" href="#latools.D_obj.D.analytes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array_like</em> – A list of analytes measured.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.data">
<code class="descname">data</code><a class="headerlink" href="#latools.D_obj.D.data" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dictionary containing the raw data, and modified data
from each processing stage. Entries can be:</p>
<blockquote>
<div><ul class="simple">
<li>‘rawdata’: created during initialisation.</li>
<li>‘despiked’: created by <cite>despike</cite></li>
<li>‘signal’: created by <cite>autorange</cite></li>
<li>‘background’: created by <cite>autorange</cite></li>
<li>‘bkgsub’: created by <cite>bkg_correct</cite></li>
<li>‘ratios’: created by <cite>ratio</cite></li>
<li>‘calibrated’: created by <cite>calibrate</cite></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.focus">
<code class="descname">focus</code><a class="headerlink" href="#latools.D_obj.D.focus" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dictionary containing one item from <cite>data</cite>. This is the
currently ‘active’ data that processing functions will
work on. This data is also directly available as class
attributes with the same names as the items in <cite>focus</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.focus_stage">
<code class="descname">focus_stage</code><a class="headerlink" href="#latools.D_obj.D.focus_stage" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – Identifies which item in <cite>data</cite> is currently assigned to <cite>focus</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.cmap">
<code class="descname">cmap</code><a class="headerlink" href="#latools.D_obj.D.cmap" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dictionary containing hex colour strings corresponding
to each measured analyte.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">bkg, sig, trn</code></dt>
<dd><p><em>array_like, bool</em> – Boolean arrays identifying signal, background and transition
regions. Created by <cite>autorange</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">bkgrng, sigrng, trnrng</code></dt>
<dd><p><em>array_like</em> – An array of shape (n, 2) containing pairs of values that
describe the Time limits of background, signal and transition
regions.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.ns">
<code class="descname">ns</code><a class="headerlink" href="#latools.D_obj.D.ns" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array_like</em> – An integer array the same length as the data, where each analysis
spot is labelled with a unique number. Used for separating
analysys spots when calculating sample statistics.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.D.filt">
<code class="descname">filt</code><a class="headerlink" href="#latools.D_obj.D.filt" title="Permalink to this definition">¶</a></dt>
<dd><p><em>filt object</em> – An object for storing, selecting and creating data filters.F</p>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.ablation_times">
<code class="descname">ablation_times</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.ablation_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.ablation_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for calculating the ablation time for each
ablation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict of times for each ablation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.autorange">
<code class="descname">autorange</code><span class="sig-paren">(</span><em>analyte='total_counts', gwin=5, swin=3, win=30, on_mult=[1.0, 1.0], off_mult=[1.0, 1.5], nbin=10, ploterrs=True, bkg_thresh=None, transform='log', **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.autorange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.autorange" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically separates signal and background data regions.</p>
<p>Automatically detect signal and background regions in the laser
data, based on the behaviour of a single analyte. The analyte used
should be abundant and homogenous in the sample.</p>
<p><strong>Step 1: Thresholding.</strong>
The background signal is determined using a gaussian kernel density
estimator (kde) of all the data. Under normal circumstances, this
kde should find two distinct data distributions, corresponding to
‘signal’ and ‘background’. The minima between these two distributions
is taken as a rough threshold to identify signal and background
regions. Any point where the trace crosses this thrshold is identified
as a ‘transition’.</p>
<p><strong>Step 2: Transition Removal.</strong>
The width of the transition regions between signal and background are
then determined, and the transitions are excluded from analysis. The
width of the transitions is determined by fitting a gaussian to the
smoothed first derivative of the analyte trace, and determining its
width at a point where the gaussian intensity is at at <cite>conf</cite> time the
gaussian maximum. These gaussians are fit to subsets of the data
centered around the transitions regions determined in Step 1, +/- <cite>win</cite>
data points. The peak is further isolated by finding the minima and
maxima of a second derivative within this window, and the gaussian is
fit to the isolated peak.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte that autorange should consider. For best results,
choose an analyte that is present homogeneously in high
concentrations.</li>
<li><strong>gwin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The smoothing window used for calculating the first derivative.
Must be odd.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Determines the width (c +/- win) of the transition data subsets.</li>
<li><strong>and off_mult</strong> (<em>on_mult</em>) – Factors to control the width of the excluded transition regions.
A region n times the full - width - half - maximum of the transition
gradient will be removed either side of the transition center.
<cite>on_mult</cite> and <cite>off_mult</cite> refer to the laser - on and laser - off
transitions, respectively. See manual for full explanation.
Defaults to (1.5, 1) and (1, 1.5).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Outputs added as instance attributes. Returns None.</em></li>
<li><strong>bkg, sig, trn</strong> (<em>iterable, bool</em>) – Boolean arrays identifying background, signal and transision
regions</li>
<li><strong>bkgrng, sigrng and trnrng</strong> (<em>iterable</em>) – (min, max) pairs identifying the boundaries of contiguous
True regions in the boolean arrays.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.autorange_plot">
<code class="descname">autorange_plot</code><span class="sig-paren">(</span><em>analyte='total_counts', gwin=7, swin=None, win=20, on_mult=[1.5, 1.0], off_mult=[1.0, 1.5], transform='log', nbin=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.autorange_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.autorange_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a detailed autorange report for this sample.</p>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.bkg_subtract">
<code class="descname">bkg_subtract</code><span class="sig-paren">(</span><em>analyte</em>, <em>bkg</em>, <em>ind=None</em>, <em>focus_stage='despiked'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.bkg_subtract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.bkg_subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract provided background from signal (focus stage).</p>
<p>Results is saved in new ‘bkgsub’ focus stage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.calibrate">
<code class="descname">calibrate</code><span class="sig-paren">(</span><em>calib_ps</em>, <em>analytes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.calibrate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.calibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply calibration to data.</p>
<p>The <cite>calib_dict</cite> must be calculated at the <cite>analyse</cite> level,
and passed to this calibrate function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>calib_dict</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dict of calibration values to apply to each analyte.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.crossplot">
<code class="descname">crossplot</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>bins=25</em>, <em>lognorm=True</em>, <em>filt=True</em>, <em>colourful=True</em>, <em>figsize=(12</em>, <em>12)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.crossplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.crossplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes against each other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>lognorm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to log normalise the colour scale
of the 2D histogram.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of bins in the 2D histogram.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.crossplot_filters">
<code class="descname">crossplot_filters</code><span class="sig-paren">(</span><em>filter_string</em>, <em>analytes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.crossplot_filters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.crossplot_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the results of a group of filters in a crossplot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filter_string</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A string that identifies a group of filters.
e.g. ‘test’ would plot all filters with ‘test’ in the
name.</li>
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">fig, axes objects</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.despike">
<code class="descname">despike</code><span class="sig-paren">(</span><em>expdecay_despiker=True</em>, <em>exponent=None</em>, <em>tstep=None</em>, <em>noise_despiker=True</em>, <em>win=3</em>, <em>nlim=12.0</em>, <em>maxiter=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.despike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.despike" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies expdecay_despiker and noise_despiker to data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>expdecay_despiker</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply the exponential decay filter.</li>
<li><strong>exponent</strong> (<a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The exponent for the exponential decay filter. If None,
it is determined automatically using <cite>find_expocoef</cite>.</li>
<li><strong>tstep</strong> (<a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The timeinterval between measurements. If None, it is
determined automatically from the Time variable.</li>
<li><strong>noise_despiker</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply the standard deviation spike filter.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The rolling window over which the spike filter calculates
the trace statistics.</li>
<li><strong>nlim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The number of standard deviations above the rolling mean
that data are excluded.</li>
<li><strong>maxiter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The max number of times that the fitler is applied.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filt_nremoved">
<code class="descname">filt_nremoved</code><span class="sig-paren">(</span><em>filt=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filt_nremoved"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filt_nremoved" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_clustering">
<code class="descname">filter_clustering</code><span class="sig-paren">(</span><em>analytes</em>, <em>filt=False</em>, <em>normalise=True</em>, <em>method='meanshift'</em>, <em>include_time=False</em>, <em>sort=None</em>, <em>min_data=10</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_clustering"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies an n - dimensional clustering filter to the data.</p>
<p>Available Clustering Algorithms</p>
<ul class="simple">
<li>‘meanshift’: The <cite>sklearn.cluster.MeanShift</cite> algorithm.
Automatically determines number of clusters
in data based on the <cite>bandwidth</cite> of expected
variation.</li>
<li>‘kmeans’: The <cite>sklearn.cluster.KMeans</cite> algorithm. Determines
the characteristics of a known number of clusters
within the data. Must provide <cite>n_clusters</cite> to specify
the expected number of clusters.</li>
<li>‘DBSCAN’: The <cite>sklearn.cluster.DBSCAN</cite> algorithm. Automatically
determines the number and characteristics of clusters
within the data based on the ‘connectivity’ of the
data (i.e. how far apart each data point is in a
multi - dimensional parameter space). Requires you to
set <cite>eps</cite>, the minimum distance point must be from
another point to be considered in the same cluster,
and <cite>min_samples</cite>, the minimum number of points that
must be within the minimum distance for it to be
considered a cluster. It may also be run in automatic
mode by specifying <cite>n_clusters</cite> alongside
<cite>min_samples</cite>, where eps is decreased until the
desired number of clusters is obtained.</li>
</ul>
<p>For more information on these algorithms, refer to the
documentation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) that the filter applies to.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
<li><strong>normalise</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to normalise the data to zero mean and unit
variance. Reccomended if clustering based on more than 1 analyte.
Uses <cite>sklearn.preprocessing.scale</cite>.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Which clustering algorithm to use (see above).</li>
<li><strong>include_time</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to include the Time variable in the clustering
analysis. Useful if you’re looking for spatially continuous
clusters in your data, i.e. this will identify each spot in your
analysis as an individual cluster.</li>
<li><strong>sort</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array-like</em>) – Whether or not to label the resulting clusters according to their
contents. If used, the cluster with the lowest values will be
labelled from 0, in order of increasing cluster mean value.analytes.
The sorting rules depend on the value of ‘sort’, which can be the name
of a single analyte (str), a list of several analyte names (array-like)
or True (bool), to specify all analytes used to calcualte the cluster.</li>
<li><strong>min_data</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of data points that should be considered by
the filter. Default = 10.</li>
<li><strong>**kwargs</strong> – Parameters passed to the clustering algorithm specified by
<cite>method</cite>.</li>
<li><strong>Parameters</strong> (<em>DBSCAN</em>) – </li>
<li><strong>--------------------</strong> – </li>
<li><strong>bandwidth</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The bandwith (float) or bandwidth method (‘scott’ or ‘silverman’)
used to estimate the data bandwidth.</li>
<li><strong>bin_seeding</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Modifies the behaviour of the meanshift algorithm. Refer to
sklearn.cluster.meanshift documentation.</li>
<li><strong>- Means Parameters</strong> (<em>K</em>) – </li>
<li><strong>------------------</strong> – </li>
<li><strong>n_clusters</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of clusters expected in the data.</li>
<li><strong>Parameters</strong> – </li>
<li><strong>-----------------</strong> – </li>
<li><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The minimum ‘distance’ points must be apart for them to be in the
same cluster. Defaults to 0.3. Note: If the data are normalised
(they should be for DBSCAN) this is in terms of total sample
variance. Normalised data have a mean of 0 and a variance of 1.</li>
<li><strong>min_samples</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of samples within distance <cite>eps</cite> required
to be considered as an independent cluster.</li>
<li><strong>n_clusters</strong> – The number of clusters expected. If specified, <cite>eps</cite> will be
incrementally reduced until the expected number of clusters is
found.</li>
<li><strong>maxiter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The maximum number of iterations DBSCAN will run.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_correlation">
<code class="descname">filter_correlation</code><span class="sig-paren">(</span><em>x_analyte</em>, <em>y_analyte</em>, <em>window=None</em>, <em>r_threshold=0.9</em>, <em>p_threshold=0.05</em>, <em>filt=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_correlation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply correlation filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y_analyte</strong> (<em>x_analyte</em><em>,</em>) – The names of the x and y analytes to correlate.</li>
<li><strong>window</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – The rolling window used when calculating the correlation.</li>
<li><strong>r_threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The correlation index above which to exclude data.
Note: the absolute pearson R value is considered, so
negative correlations below -<cite>r_threshold</cite> will also
be excluded.</li>
<li><strong>p_threshold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The significant level below which data are excluded.</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to apply existing filters to the data before
calculating this filter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_exclude_downhole">
<code class="descname">filter_exclude_downhole</code><span class="sig-paren">(</span><em>threshold</em>, <em>filt=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_exclude_downhole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_exclude_downhole" title="Permalink to this definition">¶</a></dt>
<dd><p>Exclude all points down-hole (after) the first excluded data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>threhold</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of contiguous excluded data points
that must exist before downhole exclusion occurs.</li>
<li><strong>file</strong> (<em>valid filter string</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Which filter to consider. If True, applies to currently active
filters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_gradient_threshold">
<code class="descname">filter_gradient_threshold</code><span class="sig-paren">(</span><em>analyte</em>, <em>win</em>, <em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_gradient_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_gradient_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply gradient threshold filter.</p>
<p>Generates threshold filters for the given analytes above and below
the specified threshold.</p>
<dl class="docutils">
<dt>Two filters are created with prefixes ‘_above’ and ‘_below’.</dt>
<dd>‘_above’ keeps all the data above the threshold.
‘_below’ keeps all the data below the threshold.</dd>
</dl>
<p>i.e. to select data below the threshold value, you should turn the
‘_above’ filter off.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<em>TYPE</em>) – Description of <cite>analyte</cite>.</li>
<li><strong>threshold</strong> (<em>TYPE</em>) – Description of <cite>threshold</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_new">
<code class="descname">filter_new</code><span class="sig-paren">(</span><em>name</em>, <em>filt_str</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Make new filter from combination of other filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the new filter. Should be unique.</li>
<li><strong>filt_str</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A logical combination of partial strings which will create
the new filter. For example, ‘Albelow &amp; Mnbelow’ will combine
all filters that partially match ‘Albelow’ with those that
partially match ‘Mnbelow’ using the ‘AND’ logical operator.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_report">
<code class="descname">filter_report</code><span class="sig-paren">(</span><em>filt=None</em>, <em>analytes=None</em>, <em>savedir=None</em>, <em>nbin=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualise effect of data filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Exact or partial name of filter to plot. Supports
partial matching. i.e. if ‘cluster’ is specified, all
filters with ‘cluster’ in the name will be plotted.
Defaults to all filters.</li>
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Name of analyte to plot.</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – file path to save the plot</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_threshold">
<code class="descname">filter_threshold</code><span class="sig-paren">(</span><em>analyte</em>, <em>threshold</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply threshold filter.</p>
<p>Generates threshold filters for the given analytes above and below
the specified threshold.</p>
<dl class="docutils">
<dt>Two filters are created with prefixes ‘_above’ and ‘_below’.</dt>
<dd>‘_above’ keeps all the data above the threshold.
‘_below’ keeps all the data below the threshold.</dd>
</dl>
<p>i.e. to select data below the threshold value, you should turn the
‘_above’ filter off.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<em>TYPE</em>) – Description of <cite>analyte</cite>.</li>
<li><strong>threshold</strong> (<em>TYPE</em>) – Description of <cite>threshold</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.filter_trim">
<code class="descname">filter_trim</code><span class="sig-paren">(</span><em>start=1</em>, <em>end=1</em>, <em>filt=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.filter_trim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.filter_trim" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove points from the start and end of filter regions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>end</strong> (<em>start</em><em>,</em>) – The number of points to remove from the start and end of
the specified filter.</li>
<li><strong>filt</strong> (<em>valid filter string</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Which filter to trim. If True, applies to currently active
filters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.get_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns paramters used to process data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict of analysis parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.gplot">
<code class="descname">gplot</code><span class="sig-paren">(</span><em>analytes=None, win=5, figsize=[10, 4], ranges=False, focus_stage=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.gplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.gplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes gradients as a function of Time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>array_like</em>) – list of strings containing names of analytes to plot.
None = all analytes.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window over which to calculate the rolling gradient.</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – size of final figure.</li>
<li><strong>ranges</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – show signal/background regions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">figure, axis</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.mkrngs">
<code class="descname">mkrngs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.mkrngs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.mkrngs" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform boolean arrays into list of limit pairs.</p>
<p>Gets Time limits of signal/background boolean arrays and stores them as
sigrng and bkgrng arrays. These arrays can be saved by ‘save_ranges’ in
the analyse object.</p>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.optimisation_plot">
<code class="descname">optimisation_plot</code><span class="sig-paren">(</span><em>overlay_alpha=0.5</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.optimisation_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.optimisation_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the result of signal_optimise.</p>
<p><cite>signal_optimiser</cite> must be run first, and the output
stored in the <cite>opt</cite> attribute of the latools.D object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>d</strong> (<em>latools.D object</em>) – A latools data object.</li>
<li><strong>overlay_alpha</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The opacity of the threshold overlays. Between 0 and 1.</li>
<li><strong>**kwargs</strong> – Passed to <cite>tplot</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.ratio">
<code class="descname">ratio</code><span class="sig-paren">(</span><em>internal_standard=None</em>, <em>focus='bkgsub'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide all analytes by a specified internal_standard analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>internal_standard</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte used as the internal_standard.</li>
<li><strong>focus</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analysis stage to perform the ratio calculation on.
Defaults to ‘signal’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.sample_stats">
<code class="descname">sample_stats</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>filt=True</em>, <em>stat_fns={}</em>, <em>eachtrace=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.sample_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.sample_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate sample statistics</p>
<p>Returns samples, analytes, and arrays of statistics
of shape (samples, analytes). Statistics are calculated
from the ‘focus’ data variable, so output depends on how
the data have been processed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>array_like</em>) – List of analytes to calculate the statistic on</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – <dl class="docutils">
<dt>The filter to apply to the data when calculating sample statistics.</dt>
<dd>bool: True applies filter specified in filt.switches.
str: logical string specifying a partucular filter</dd>
</dl>
</li>
<li><strong>stat_fns</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dict of {name: function} pairs. Functions that take a single
array_like input, and return a single statistic. Function should
be able to cope with NaN values.</li>
<li><strong>eachtrace</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – True: per - ablation statistics
False: whole sample statistics</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.setfocus">
<code class="descname">setfocus</code><span class="sig-paren">(</span><em>focus</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.setfocus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.setfocus" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the ‘focus’ attribute of the data file.</p>
<p>The ‘focus’ attribute of the object points towards data from a
particular stage of analysis. It is used to identify the ‘working
stage’ of the data. Processing functions operate on the ‘focus’
stage, so if steps are done out of sequence, things will break.</p>
<p>Names of analysis stages:</p>
<ul class="simple">
<li>‘rawdata’: raw data, loaded from csv file when object
is initialised.</li>
<li>‘despiked’: despiked data.</li>
<li>‘signal’/’background’: isolated signal and background data,
padded with np.nan. Created by self.separate, after
signal and background regions have been identified by
self.autorange.</li>
<li>‘bkgsub’: background subtracted data, created by
self.bkg_correct</li>
<li>‘ratios’: element ratio data, created by self.ratio.</li>
<li>‘calibrated’: ratio data calibrated to standards, created by
self.calibrate.</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>focus</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the analysis stage desired.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.signal_optimiser">
<code class="descname">signal_optimiser</code><span class="sig-paren">(</span><em>analytes</em>, <em>min_points=5</em>, <em>threshold_mode='kde_first_max'</em>, <em>threshold_mult=1.0</em>, <em>x_bias=0</em>, <em>weights=None</em>, <em>filt=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.signal_optimiser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.signal_optimiser" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimise data selection based on specified analytes.</p>
<p>Identifies the longest possible contiguous data region in
the signal where the relative standard deviation (std) and
concentration of all analytes is minimised.</p>
<p>Optimisation is performed via a grid search of all possible
contiguous data regions. For each region, the mean std and
mean scaled analyte concentration (‘amplitude’) are calculated.</p>
<p>The size and position of the optimal data region are identified
using threshold std and amplitude values. Thresholds are derived
from all calculated stds and amplitudes using the method specified
by <cite>threshold_mode</cite>. For example, using the ‘kde_max’ method, a
probability density function (PDF) is calculated for std and
amplitude values, and the threshold is set as the maximum of the
PDF. These thresholds are then used to identify the size and position
of the longest contiguous region where the std is below the threshold,
and the amplitude is either below the threshold.</p>
<p>All possible regions of the data that have at least
<cite>min_points</cite> are considered.</p>
<p>For a graphical demonstration of the action of signal_optimiser,
use <cite>optimisation_plot</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>d</strong> (<em>latools.D object</em>) – An latools data object.</li>
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array-like</em>) – Which analytes to consider.</li>
<li><strong>min_points</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of contiguous points to
consider.</li>
<li><strong>threshold_mode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The method used to calculate the optimisation
thresholds. Can be ‘mean’, ‘median’, ‘kde_max’
or ‘bayes_mvs’, or a custom function. If a
function, must take a 1D array, and return a
single, real number.</li>
<li><strong>weights</strong> (<em>array-like of length len</em><em>(</em><a class="reference internal" href="#latools.latools.analyse.analytes" title="latools.latools.analyse.analytes"><em>analytes</em></a><em>)</em>) – An array of numbers specifying the importance of
each analyte considered. Larger number makes the
analyte have a greater effect on the optimisation.
Default is None.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D_obj.D.tplot">
<code class="descname">tplot</code><span class="sig-paren">(</span><em>analytes=None, figsize=[10, 4], scale='log', filt=None, ranges=False, stats=False, stat='nanmean', err='nanstd', interactive=False, focus_stage=None, err_envelope=False, ax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/D_obj.html#D.tplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.D_obj.D.tplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes as a function of Time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>array_like</em>) – list of strings containing names of analytes to plot.
None = all analytes.</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – size of final figure.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – ‘log’ = plot data on log scale</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – False: plot unfiltered data.
True: plot filtered data over unfiltered data.
str: apply filter key to all analytes
dict: apply key to each analyte in dict. Must contain all
analytes plotted. Can use self.filt.keydict.</li>
<li><strong>ranges</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – show signal/background regions.</li>
<li><strong>stats</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – plot average and error of each trace, as specified by <cite>stat</cite> and
<cite>err</cite>.</li>
<li><strong>stat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – average statistic to plot.</li>
<li><strong>err</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – error statistic to plot.</li>
<li><strong>interactive</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Make the plot interactive.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">figure, axis</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="filtering">
<h2>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="latools.filtering.filt_obj.filt">
<em class="property">class </em><code class="descclassname">latools.filtering.filt_obj.</code><code class="descname">filt</code><span class="sig-paren">(</span><em>size</em>, <em>analytes</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Container for creating, storing and selecting data filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The length that the filters need to be (should be
the same as your data).</li>
<li><strong>analytes</strong> (<em>array_like</em>) – A list of the analytes measured in your data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="latools.D_obj.filt.size">
<code class="descname">size</code><a class="headerlink" href="#latools.D_obj.filt.size" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – The length that the filters need to be (should be
the same as your data).</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.analytes">
<code class="descname">analytes</code><a class="headerlink" href="#latools.D_obj.filt.analytes" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array_like</em> – A list of the analytes measured in your data.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.components">
<code class="descname">components</code><a class="headerlink" href="#latools.D_obj.filt.components" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dict containing each individual filter that has been
created.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.info">
<code class="descname">info</code><a class="headerlink" href="#latools.D_obj.filt.info" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dict containing descriptive information about each
filter in <cite>components</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.params">
<code class="descname">params</code><a class="headerlink" href="#latools.D_obj.filt.params" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dict containing the parameters used to create
each filter, which can be passed directly to the
corresponding filter function to recreate the filter.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.switches">
<code class="descname">switches</code><a class="headerlink" href="#latools.D_obj.filt.switches" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dict of boolean switches specifying which filters
are active for each analyte.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.keys">
<code class="descname">keys</code><a class="headerlink" href="#latools.D_obj.filt.keys" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A dict of logical strings specifying which filters are
applied to each analyte.</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.sequence">
<code class="descname">sequence</code><a class="headerlink" href="#latools.D_obj.filt.sequence" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – A numbered dict specifying what order the filters were
applied in (for some filters, order matters).</p>
</dd></dl>

<dl class="attribute">
<dt id="latools.D_obj.filt.n">
<code class="descname">n</code><a class="headerlink" href="#latools.D_obj.filt.n" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> – The number of filters applied to the data.</p>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>name</em>, <em>filt</em>, <em>info=''</em>, <em>params=()</em>, <em>setn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – filter name</li>
<li><strong>filt</strong> (<em>array_like</em>) – boolean filter array</li>
<li><strong>info</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – informative description of the filter</li>
<li><strong>params</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – parameters used to make the filter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove unused filters.</p>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all filters.</p>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.fuzzmatch">
<code class="descname">fuzzmatch</code><span class="sig-paren">(</span><em>fuzzkey</em>, <em>multi=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.fuzzmatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.fuzzmatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify a filter by fuzzy string matching.</p>
<p>Partial (‘fuzzy’) matching performed by <cite>fuzzywuzzy.fuzzy.ratio</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fuzzkey</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – A string that partially matches one filter name more than the others.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>The name of the most closely matched filter.</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.get_components">
<code class="descname">get_components</code><span class="sig-paren">(</span><em>key</em>, <em>analyte=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.get_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.get_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract filter components for specific analyte(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – string present in one or more filter names.
e.g. ‘Al27’ will return all filters with
‘Al27’ in their names.</li>
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – name of analyte the filter is for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>boolean filter</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array-like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.get_info">
<code class="descname">get_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.get_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get info for all filters.</p>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.grab_filt">
<code class="descname">grab_filt</code><span class="sig-paren">(</span><em>filt</em>, <em>analyte=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.grab_filt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.grab_filt" title="Permalink to this definition">¶</a></dt>
<dd><p>Flexible access to specific filter using any key format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – either logical filter expression, dict of expressions,
or a boolean</li>
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – name of analyte the filter is for.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">boolean filter</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.make">
<code class="descname">make</code><span class="sig-paren">(</span><em>analyte</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.make"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.make" title="Permalink to this definition">¶</a></dt>
<dd><p>Make filter for specified analyte(s).</p>
<p>Filter specified in filt.switches.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name or list of names of analytes.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">boolean filter</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.make_fromkey">
<code class="descname">make_fromkey</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.make_fromkey"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.make_fromkey" title="Permalink to this definition">¶</a></dt>
<dd><p>Make filter from logical expression.</p>
<p>Takes a logical expression as an input, and returns a filter. Used for advanced
filtering, where combinations of nested and/or filters are desired. Filter names must
exactly match the names listed by print(filt).</p>
<p>Example: <code class="docutils literal"><span class="pre">key</span> <span class="pre">=</span> <span class="pre">'(Filter_1</span> <span class="pre">|</span> <span class="pre">Filter_2)</span> <span class="pre">&amp;</span> <span class="pre">Filter_3'</span></code>
is equivalent to:
<code class="docutils literal"><span class="pre">(Filter_1</span> <span class="pre">OR</span> <span class="pre">Filter_2)</span> <span class="pre">AND</span> <span class="pre">Filter_3</span></code>
statements in parentheses are evaluated first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – logical expression describing filter construction.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">boolean filter</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.make_keydict">
<code class="descname">make_keydict</code><span class="sig-paren">(</span><em>analyte=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.make_keydict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.make_keydict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make logical expressions describing the filter(s) for specified analyte(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>analyte</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name or list of names of analytes.
Defaults to all analytes.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">containing the logical filter expression for each analyte.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.off">
<code class="descname">off</code><span class="sig-paren">(</span><em>analyte=None</em>, <em>filt=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.off"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.off" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn off specified filter(s) for specified analyte(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name or list of names of analytes.
Defaults to all analytes.</li>
<li><strong>filt</strong> (<em>optional. int</em><em>, </em><em>list of int</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Number(s) or partial string that corresponds to filter name(s).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.on">
<code class="descname">on</code><span class="sig-paren">(</span><em>analyte=None</em>, <em>filt=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.on"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.on" title="Permalink to this definition">¶</a></dt>
<dd><p>Turn on specified filter(s) for specified analyte(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analyte</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name or list of names of analytes.
Defaults to all analytes.</li>
<li><strong>filt</strong> (<em>optional. int</em><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array_like</em>) – Name/number or iterable names/numbers of filters.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.filt_obj.filt.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>name=None</em>, <em>setn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/filt_obj.html#filt.remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.filt_obj.filt.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – name of the filter to remove</li>
<li><strong>setn</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#True" title="(in Python v2.7)"><em>True</em></a>) – int: number of set to remove
True: remove all filters in set that ‘name’ belongs to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-latools.filtering.signal_optimiser"></span><p>Functions for automatic selection optimisation.</p>
<dl class="function">
<dt id="latools.filtering.signal_optimiser.bayes_scale">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">bayes_scale</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#bayes_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.bayes_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove mean and divide by standard deviation, using bayes_kvm statistics.</p>
</dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.calc_window_mean_std">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">calc_window_mean_std</code><span class="sig-paren">(</span><em>s</em>, <em>min_points</em>, <em>ind=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#calc_window_mean_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.calc_window_mean_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply fn to all contiguous regions in s that have at least min_points.</p>
</dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.calc_windows">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">calc_windows</code><span class="sig-paren">(</span><em>fn</em>, <em>s</em>, <em>min_points</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#calc_windows"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.calc_windows" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply fn to all contiguous regions in s that have at least min_points.</p>
</dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.calculate_optimisation_stats">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">calculate_optimisation_stats</code><span class="sig-paren">(</span><em>d</em>, <em>analytes</em>, <em>min_points</em>, <em>weights</em>, <em>ind</em>, <em>x_bias=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#calculate_optimisation_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.calculate_optimisation_stats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.median_scaler">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">median_scaler</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#median_scaler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.median_scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove median, divide by IQR.</p>
</dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.optimisation_plot">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">optimisation_plot</code><span class="sig-paren">(</span><em>d</em>, <em>overlay_alpha=0.5</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#optimisation_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.optimisation_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the result of signal_optimise.</p>
<p><cite>signal_optimiser</cite> must be run first, and the output
stored in the <cite>opt</cite> attribute of the latools.D object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>d</strong> (<em>latools.D object</em>) – A latools data object.</li>
<li><strong>overlay_alpha</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The opacity of the threshold overlays. Between 0 and 1.</li>
<li><strong>**kwargs</strong> – Passed to <cite>tplot</cite></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.scale">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">scale</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the mean, and divide by the standard deviation.</p>
</dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.scaler">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">scaler</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.filtering.signal_optimiser.scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove median, divide by IQR.</p>
</dd></dl>

<dl class="function">
<dt id="latools.filtering.signal_optimiser.signal_optimiser">
<code class="descclassname">latools.filtering.signal_optimiser.</code><code class="descname">signal_optimiser</code><span class="sig-paren">(</span><em>d</em>, <em>analytes</em>, <em>min_points=5</em>, <em>threshold_mode='kde_first_max'</em>, <em>threshold_mult=1.0</em>, <em>x_bias=0</em>, <em>weights=None</em>, <em>ind=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/signal_optimiser.html#signal_optimiser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.signal_optimiser.signal_optimiser" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimise data selection based on specified analytes.</p>
<p>Identifies the longest possible contiguous data region in
the signal where the relative standard deviation (std) and
concentration of all analytes is minimised.</p>
<p>Optimisation is performed via a grid search of all possible
contiguous data regions. For each region, the mean std and
mean scaled analyte concentration (‘amplitude’) are calculated.</p>
<p>The size and position of the optimal data region are identified
using threshold std and amplitude values. Thresholds are derived
from all calculated stds and amplitudes using the method specified
by <cite>threshold_mode</cite>. For example, using the ‘kde_max’ method, a
probability density function (PDF) is calculated for std and
amplitude values, and the threshold is set as the maximum of the
PDF. These thresholds are then used to identify the size and position
of the longest contiguous region where the std is below the threshold,
and the amplitude is either below the threshold.</p>
<p>All possible regions of the data that have at least
<cite>min_points</cite> are considered.</p>
<p>For a graphical demonstration of the action of signal_optimiser,
use <cite>optimisation_plot</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>d</strong> (<em>latools.D object</em>) – An latools data object.</li>
<li><strong>analytes</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array-like</em>) – Which analytes to consider.</li>
<li><strong>min_points</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The minimum number of contiguous points to
consider.</li>
<li><strong>threshold_mode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The method used to calculate the optimisation
thresholds. Can be ‘mean’, ‘median’, ‘kde_max’
or ‘bayes_mvs’, or a custom function. If a
function, must take a 1D array, and return a
single, real number.</li>
<li><strong>threshood_mult</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – A multiplier applied to the calculated threshold
before use. If a tuple, the first value is applied
to the mean threshold, and the second is applied to
the standard deviation threshold. Reduce this to make
data selection more stringent.</li>
<li><strong>x_bias</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – If non-zero, a bias is applied to the calculated statistics
to prefer the beginning (if &gt; 0) or end (if &lt; 0) of the
signal. Should be between zero and 1.</li>
<li><strong>weights</strong> (<em>array-like of length len</em><em>(</em><a class="reference internal" href="#latools.latools.analyse.analytes" title="latools.latools.analyse.analytes"><em>analytes</em></a><em>)</em>) – An array of numbers specifying the importance of
each analyte considered. Larger number makes the
analyte have a greater effect on the optimisation.
Default is None.</li>
<li><strong>ind</strong> (<em>boolean array</em>) – A boolean array the same length as the data. Where
false, data will not be included.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>optimisation result</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)">dict</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-latools.filtering.classifier_obj"></span><dl class="class">
<dt id="latools.filtering.classifier_obj.classifier">
<em class="property">class </em><code class="descclassname">latools.filtering.classifier_obj.</code><code class="descname">classifier</code><span class="sig-paren">(</span><em>analytes</em>, <em>sort_by=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>data</em>, <em>method='kmeans'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>fit classifiers from large dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dict of data for clustering. Must contain
items with the same name as analytes used for
clustering.</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – <p>A string defining the clustering method used. Can be:</p>
<ul>
<li>’kmeans’ : K-Means clustering algorithm</li>
<li>’meanshift’ : Meanshift algorithm</li>
</ul>
</li>
<li><strong>n_clusters</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – <em>K-Means only</em>. The numebr of clusters to identify</li>
<li><strong>bandwidth</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – <em>Meanshift only.</em>
The bandwidth value used during clustering.
If none, determined automatically. Note:
the data are scaled before clutering, so
this is not in the same units as the data.</li>
<li><strong>bin_seeding</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – <em>Meanshift only.</em>
Whether or not to use ‘bin_seeding’. See
documentation for <cite>sklearn.cluster.MeanShift</cite>.</li>
<li><strong>**kwargs</strong> – passed to <cite>sklearn.cluster.MeanShift</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.fit_kmeans">
<code class="descname">fit_kmeans</code><span class="sig-paren">(</span><em>data</em>, <em>n_clusters</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.fit_kmeans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.fit_kmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit KMeans clustering algorithm to data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array-like</em>) – A dataset formatted by <cite>classifier.fitting_data</cite>.</li>
<li><strong>n_clusters</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of clusters in the data.</li>
<li><strong>**kwargs</strong> – passed to <cite>sklearn.cluster.KMeans</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Fitted <cite>sklearn.cluster.KMeans</cite> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.fit_meanshift">
<code class="descname">fit_meanshift</code><span class="sig-paren">(</span><em>data</em>, <em>bandwidth=None</em>, <em>bin_seeding=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.fit_meanshift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.fit_meanshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit MeanShift clustering algorithm to data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>array-like</em>) – A dataset formatted by <cite>classifier.fitting_data</cite>.</li>
<li><strong>bandwidth</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The bandwidth value used during clustering.
If none, determined automatically. Note:
the data are scaled before clutering, so
this is not in the same units as the data.</li>
<li><strong>bin_seeding</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to use ‘bin_seeding’. See
documentation for <cite>sklearn.cluster.MeanShift</cite>.</li>
<li><strong>**kwargs</strong> – passed to <cite>sklearn.cluster.MeanShift</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Fitted <cite>sklearn.cluster.MeanShift</cite> object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.fitting_data">
<code class="descname">fitting_data</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.fitting_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.fitting_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to format data for cluster fitting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dict of data, containing all elements of
<cite>analytes</cite> as items.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A data array for initial cluster fitting.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.format_data">
<code class="descname">format_data</code><span class="sig-paren">(</span><em>data</em>, <em>scale=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.format_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.format_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for converting a dict to an array suitable for sklearn.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dict of data, containing all elements of
<cite>analytes</cite> as items.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to scale the data. Should always be
<cite>True</cite>, unless used by <cite>classifier.fitting_data</cite>
where a scaler hasn’t been created yet.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A data array suitable for use with <cite>sklearn.cluster</cite>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.map_clusters">
<code class="descname">map_clusters</code><span class="sig-paren">(</span><em>size</em>, <em>sampled</em>, <em>clusters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.map_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.map_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Translate cluster identity back to original data size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – size of original dataset</li>
<li><strong>sampled</strong> (<em>array-like</em>) – integer array describing location of finite values
in original data.</li>
<li><strong>clusters</strong> (<em>array-like</em>) – integer array of cluster identities</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>list of cluster identities the same length as original</em></li>
<li><em>data. Where original data are non-finite, returns -2.</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Label new data with cluster identities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A data dict containing the same analytes used to
fit the classifier.</li>
<li><strong>sort_by</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of an analyte used to sort the resulting
clusters. If None, defaults to the first analyte
used in fitting.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of clusters the same length as the data.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.filtering.classifier_obj.classifier.sort_clusters">
<code class="descname">sort_clusters</code><span class="sig-paren">(</span><em>data</em>, <em>cs</em>, <em>sort_by</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/filtering/classifier_obj.html#classifier.sort_clusters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.filtering.classifier_obj.classifier.sort_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort clusters by the concentration of a particular analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dataset containing sort_by as a key.</li>
<li><strong>cs</strong> (<em>array-like</em>) – An array of clusters, the same length as values of data.</li>
<li><strong>sort_by</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – analyte to sort the clusters by</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of clusters, sorted by mean value of sort_by analyte.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-latools.helpers.helpers">
<span id="helpers"></span><h2>Helpers<a class="headerlink" href="#module-latools.helpers.helpers" title="Permalink to this headline">¶</a></h2>
<p>Helper functions used by multiple parts of LAtools.</p>
<dl class="class">
<dt id="latools.helpers.helpers.Bunch">
<em class="property">class </em><code class="descclassname">latools.helpers.helpers.</code><code class="descname">Bunch</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#Bunch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.Bunch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">dict</span></code></a></p>
<dl class="method">
<dt id="latools.helpers.helpers.Bunch.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None.  Remove all items from D.<a class="headerlink" href="#latools.helpers.helpers.Bunch.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; a shallow copy of D<a class="headerlink" href="#latools.helpers.helpers.Bunch.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.fromkeys">
<code class="descname">fromkeys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#latools.helpers.helpers.Bunch.fromkeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new dict with keys from iterable and values equal to value.</p>
</dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>k</em><span class="optional">[</span>, <em>d</em><span class="optional">]</span><span class="sig-paren">)</span> &#x2192; D[k] if k in D, else d.  d defaults to None.<a class="headerlink" href="#latools.helpers.helpers.Bunch.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.items">
<code class="descname">items</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; a set-like object providing a view on D's items<a class="headerlink" href="#latools.helpers.helpers.Bunch.items" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; a set-like object providing a view on D's keys<a class="headerlink" href="#latools.helpers.helpers.Bunch.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><em>k</em><span class="optional">[</span>, <em>d</em><span class="optional">]</span><span class="sig-paren">)</span> &#x2192; v, remove specified key and return the corresponding value.<a class="headerlink" href="#latools.helpers.helpers.Bunch.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>If key is not found, d is returned if given, otherwise KeyError is raised</p>
</dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.popitem">
<code class="descname">popitem</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; (k, v), remove and return some (key, value) pair as a<a class="headerlink" href="#latools.helpers.helpers.Bunch.popitem" title="Permalink to this definition">¶</a></dt>
<dd><p>2-tuple; but raise KeyError if D is empty.</p>
</dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.setdefault">
<code class="descname">setdefault</code><span class="sig-paren">(</span><em>k</em><span class="optional">[</span>, <em>d</em><span class="optional">]</span><span class="sig-paren">)</span> &#x2192; D.get(k,d), also set D[k]=d if k not in D<a class="headerlink" href="#latools.helpers.helpers.Bunch.setdefault" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.update">
<code class="descname">update</code><span class="sig-paren">(</span><span class="optional">[</span><em>E</em>, <span class="optional">]</span><em>**F</em><span class="sig-paren">)</span> &#x2192; None.  Update D from dict/iterable E and F.<a class="headerlink" href="#latools.helpers.helpers.Bunch.update" title="Permalink to this definition">¶</a></dt>
<dd><p>If E is present and has a .keys() method, then does:  for k in E: D[k] = E[k]
If E is present and lacks a .keys() method, then does:  for k, v in E: D[k] = v
In either case, this is followed by: for k in F:  D[k] = F[k]</p>
</dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.Bunch.values">
<code class="descname">values</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; an object providing a view on D's values<a class="headerlink" href="#latools.helpers.helpers.Bunch.values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.add_config">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">add_config</code><span class="sig-paren">(</span><em>config_name</em>, <em>params</em>, <em>config_file=None</em>, <em>make_default=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#add_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.add_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new configuration to latools.cfg.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>config_name</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The name of the new configuration. This should be descriptive
(e.g. UC Davis Foram Group)</li>
<li><strong>params</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – <p>A (parameter, value) dict defining non - default parameters
associated with the new configuration.
Possible parameters include:</p>
<dl class="docutils">
<dt>srmfile <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd>Path to srm file used in calibration. Defaults to GeoRem
values for NIST610, NIST612 and NIST614 provided with latools.</dd>
<dt>dataformat <span class="classifier-delimiter">:</span> <span class="classifier">dict (as str)</span></dt>
<dd>See dataformat documentation.</dd>
</dl>
</li>
<li><strong>config_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to the configuration file that will be modified. Defaults to
latools.cfg in package install location.</li>
<li><strong>make_default</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to make the new configuration the default
for future analyses. Default = True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.bool_2_indices">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">bool_2_indices</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#bool_2_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.bool_2_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert boolean array into a 2D array of (start, stop) pairs.</p>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.calc_grads">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">calc_grads</code><span class="sig-paren">(</span><em>x</em>, <em>dat</em>, <em>keys=None</em>, <em>win=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#calc_grads"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.calc_grads" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate gradients of values in dat.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array like</em>) – Independent variable for items in dat.</li>
<li><strong>dat</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – {key: dependent_variable} pairs</li>
<li><strong>keys</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>array-like</em>) – Which keys in dict to calculate the gradient of.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The side of the rolling window for gradient calculation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict of gradients</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.collate_data">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">collate_data</code><span class="sig-paren">(</span><em>in_dir</em>, <em>extension='.csv'</em>, <em>out_dir=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#collate_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.collate_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy all csvs in nested directroy to single directory.</p>
<p>Function to copy all csvs from a directory, and place
them in a new directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>in_dir</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Input directory containing csv files in subfolders</li>
<li><strong>extension</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The extension that identifies your data files.
Defaults to ‘.csv’.</li>
<li><strong>out_dir</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Destination directory</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.config_locator">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">config_locator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#config_locator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.config_locator" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the location of the latools.cfg file.</p>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.enumerate_bool">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">enumerate_bool</code><span class="sig-paren">(</span><em>bool_array</em>, <em>nstart=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#enumerate_bool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.enumerate_bool" title="Permalink to this definition">¶</a></dt>
<dd><p>Consecutively numbers contiguous booleans in array.</p>
<p>i.e. a boolean sequence, and resulting numbering
T F T T T F T F F F T T F
0-1 1 1 - 2 —3 3 -</p>
<p>where ‘ - ‘</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bool_array</strong> (<em>array_like</em>) – Array of booleans.</li>
<li><strong>nstart</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of the first boolean group.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.fastgrad">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">fastgrad</code><span class="sig-paren">(</span><em>a</em>, <em>win=11</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#fastgrad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.fastgrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns rolling - window gradient of a.</p>
<p>Function to efficiently calculate the rolling gradient of a numpy
array using ‘stride_tricks’ to split up a 1D array into an ndarray of
sub - sections of the original array, of dimensions [len(a) - win, win].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>array_like</em>) – The 1D array to calculate the rolling gradient of.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The width of the rolling window.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Gradient of a, assuming as constant integer x - scale.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.fastsmooth">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">fastsmooth</code><span class="sig-paren">(</span><em>a</em>, <em>win=11</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#fastsmooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.fastsmooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns rolling - window smooth of a.</p>
<p>Function to efficiently calculate the rolling mean of a numpy
array using ‘stride_tricks’ to split up a 1D array into an ndarray of
sub - sections of the original array, of dimensions [len(a) - win, win].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>array_like</em>) – The 1D array to calculate the rolling gradient of.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The width of the rolling window.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Gradient of a, assuming as constant integer x - scale.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.findmins">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">findmins</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#findmins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.findmins" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to find local minima.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>y</strong> (<em>x</em><em>,</em>) – 1D arrays of the independent (x) and dependent (y) variables.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Array of points in x where y has a local minimum.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array_like</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.get_date">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">get_date</code><span class="sig-paren">(</span><em>datetime</em>, <em>time_format=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#get_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.get_date" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a datetime oject from a string, with optional time format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>datetime</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Date-time as string in any sensible format.</li>
<li><strong>time_format</strong> (<em>datetime str</em><em> (</em><em>optional</em><em>)</em>) – String describing the datetime format. If missing uses
dateutil.parser to guess time format.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.get_example_data">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">get_example_data</code><span class="sig-paren">(</span><em>destination_dir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#get_example_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.get_example_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.intial_configuration">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">intial_configuration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#intial_configuration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.intial_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for configuring latools.</p>
<p>Run this function when you first use <cite>latools</cite> to specify the
location of you SRM data file and your data format file.</p>
<p>See documentation for full details.</p>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.pretty_element">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">pretty_element</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#pretty_element"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.pretty_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns formatted element name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – of format [A-Z][a-z]?[0-9]+</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">LaTeX formatted string with superscript numbers.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.rangecalc">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">rangecalc</code><span class="sig-paren">(</span><em>xs</em>, <em>pad=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#rangecalc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.rangecalc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.rolling_window">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">rolling_window</code><span class="sig-paren">(</span><em>a</em>, <em>window</em>, <em>pad=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#rolling_window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.rolling_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns (win, len(a)) rolling - window array of data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>array_like</em>) – Array to calculate the rolling window of</li>
<li><strong>window</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – Description of <cite>window</cite>.</li>
<li><strong>pad</strong> (<em>same as dtype</em><em>(</em><em>a</em><em>)</em>) – Description of <cite>pad</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An array of shape (n, window), where n is either len(a) - window
if pad is None, or len(a) if pad is not None.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.stack_keys">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">stack_keys</code><span class="sig-paren">(</span><em>ddict</em>, <em>keys</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#stack_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.stack_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine elements of ddict into an array of shape (len(ddict[key]), len(keys)).</p>
<p>Useful for preparing data for sklearn.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ddict</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dict containing arrays or lists to be stacked.
Must be of equal length.</li>
<li><strong>keys</strong> (<em>list</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The keys of dict to stack. Must be present in ddict.</li>
<li><strong>extra</strong> (<em>list</em><em> (</em><em>optional</em><em>)</em>) – A list of additional arrays to stack. Elements of extra
must be the same length as arrays in ddict.
Extras are inserted as the first columns of output.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.tuples_2_bool">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">tuples_2_bool</code><span class="sig-paren">(</span><em>tuples</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#tuples_2_bool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.tuples_2_bool" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate boolean array from list of limit tuples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tuples</strong> (<em>array_like</em>) – [2, n] array of (start, end) values</li>
<li><strong>x</strong> (<em>array_like</em>) – x scale the tuples are mapped to</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">boolean array, True where x is between each pair of tuples.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="latools.helpers.helpers.un_interp1d">
<em class="property">class </em><code class="descclassname">latools.helpers.helpers.</code><code class="descname">un_interp1d</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#un_interp1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.un_interp1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/2/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>object for handling interpolation of values with uncertainties.</p>
<dl class="method">
<dt id="latools.helpers.helpers.un_interp1d.new">
<code class="descname">new</code><span class="sig-paren">(</span><em>xn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#un_interp1d.new"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.un_interp1d.new" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.un_interp1d.new_nom">
<code class="descname">new_nom</code><span class="sig-paren">(</span><em>xn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#un_interp1d.new_nom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.un_interp1d.new_nom" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.helpers.helpers.un_interp1d.new_std">
<code class="descname">new_std</code><span class="sig-paren">(</span><em>xn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#un_interp1d.new_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.un_interp1d.new_std" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="latools.helpers.helpers.unitpicker">
<code class="descclassname">latools.helpers.helpers.</code><code class="descname">unitpicker</code><span class="sig-paren">(</span><em>a</em>, <em>llim=0.1</em>, <em>denominator=None</em>, <em>focus_stage=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/helpers.html#unitpicker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.helpers.unitpicker" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the most appropriate plotting unit for data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>array-like</em>) – number to optimise. If array like, the 25% quantile is optimised.</li>
<li><strong>llim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – minimum allowable value in scaled data.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(multiplier, unit)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a>, <a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)">str</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-latools.helpers.chemistry"></span><dl class="function">
<dt id="latools.helpers.chemistry.calc_M">
<code class="descclassname">latools.helpers.chemistry.</code><code class="descname">calc_M</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/chemistry.html#calc_M"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.chemistry.calc_M" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns molecular weight of molecule.</p>
<p>Where molecule is in standard chemical notation,
e.g. ‘CO2’, ‘HCO3’ or B(OH)4</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>molecular_weight</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.chemistry.elements">
<code class="descclassname">latools.helpers.chemistry.</code><code class="descname">elements</code><span class="sig-paren">(</span><em>all_isotopes=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/chemistry.html#elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.chemistry.elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a DataFrame of all elements and isotopes.</p>
<p>Scraped from <a class="reference external" href="https://www.webelements.com/">https://www.webelements.com/</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">pandas DataFrame with columns (element, atomic_number, isotope, atomic_weight, percent)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.chemistry.to_mass_fraction">
<code class="descclassname">latools.helpers.chemistry.</code><code class="descname">to_mass_fraction</code><span class="sig-paren">(</span><em>molar_ratio</em>, <em>massfrac_denominator</em>, <em>numerator_mass</em>, <em>denominator_mass</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/chemistry.html#to_mass_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.chemistry.to_mass_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts per-mass concentrations to molar elemental ratios.</p>
<p>Be careful with units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>molar_ratio</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>array-like</em>) – The molar ratio of elements.</li>
<li><strong>massfrac_denominator</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>array-like</em>) – The mass fraction of the denominator element</li>
<li><strong>denominator_mass</strong> (<em>numerator_mass</em><em>,</em>) – The atomic mass of the numerator and denominator.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>float or array-like</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">The mass fraction of the numerator element.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.chemistry.to_molar_ratio">
<code class="descclassname">latools.helpers.chemistry.</code><code class="descname">to_molar_ratio</code><span class="sig-paren">(</span><em>massfrac_numerator</em>, <em>massfrac_denominator</em>, <em>numerator_mass</em>, <em>denominator_mass</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/chemistry.html#to_molar_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.chemistry.to_molar_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts per-mass concentrations to molar elemental ratios.</p>
<p>Be careful with units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>denominator_mass</strong> (<em>numerator_mass</em><em>,</em>) – The atomic mass of the numerator and denominator.</li>
<li><strong>massfrac_denominator</strong> (<em>massfrac_numerator</em><em>,</em>) – The per-mass fraction of the numnerator and denominator.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>float or array-like</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">The molar ratio of elements in the material</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-latools.helpers.process_fns"></span><dl class="function">
<dt id="latools.helpers.process_fns.autorange">
<code class="descclassname">latools.helpers.process_fns.</code><code class="descname">autorange</code><span class="sig-paren">(</span><em>t</em>, <em>sig</em>, <em>gwin=7</em>, <em>swin=None</em>, <em>win=30</em>, <em>on_mult=(1.5</em>, <em>1.0)</em>, <em>off_mult=(1.0</em>, <em>1.5)</em>, <em>nbin=10</em>, <em>thresh=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/process_fns.html#autorange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.process_fns.autorange" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically separates signal and background in an on/off data stream.</p>
<p><strong>Step 1: Thresholding.</strong>
The background signal is determined using a gaussian kernel density
estimator (kde) of all the data. Under normal circumstances, this
kde should find two distinct data distributions, corresponding to
‘signal’ and ‘background’. The minima between these two distributions
is taken as a rough threshold to identify signal and background
regions. Any point where the trace crosses this thrshold is identified
as a ‘transition’.</p>
<p><strong>Step 2: Transition Removal.</strong>
The width of the transition regions between signal and background are
then determined, and the transitions are excluded from analysis. The
width of the transitions is determined by fitting a gaussian to the
smoothed first derivative of the analyte trace, and determining its
width at a point where the gaussian intensity is at at <cite>conf</cite> time the
gaussian maximum. These gaussians are fit to subsets of the data
centered around the transitions regions determined in Step 1, +/- <cite>win</cite>
data points. The peak is further isolated by finding the minima and
maxima of a second derivative within this window, and the gaussian is
fit to the isolated peak.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>array-like</em>) – Independent variable (usually time).</li>
<li><strong>sig</strong> (<em>array-like</em>) – Dependent signal, with distinctive ‘on’ and ‘off’ regions.</li>
<li><strong>gwin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window used for calculating first derivative.
Defaults to 7.</li>
<li><strong>swin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window ised for signal smoothing. If None, <code class="docutils literal"><span class="pre">gwin</span> <span class="pre">//</span> <span class="pre">2</span></code>.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The width (c +/- win) of the transition data subsets.
Defaults to 20.</li>
<li><strong>and off_mult</strong> (<em>on_mult</em>) – Control the width of the excluded transition regions, which is defined
relative to the peak full-width-half-maximum (FWHM) of the transition
gradient. The region n * FHWM below the transition, and m * FWHM above
the tranision will be excluded, where (n, m) are specified in <cite>on_mult</cite>
and <cite>off_mult</cite>.
<cite>on_mult</cite> and <cite>off_mult</cite> apply to the off-on and on-off transitions,
respectively.
Defaults to (1.5, 1) and (1, 1.5).</li>
<li><strong>nbin</strong> (<em>ind</em>) – Used to calculate the number of bins in the data histogram.
<code class="docutils literal"><span class="pre">bins</span> <span class="pre">=</span> <span class="pre">len(sig)</span> <span class="pre">//</span> <span class="pre">nbin</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fbkg, fsig, ftrn, failed</strong> – where fbkg, fsig and ftrn are boolean arrays the same length as sig,
that are True where sig is background, signal and transition, respecively.
failed contains a list of transition positions where gaussian fitting
has failed.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.process_fns.expdecay_despike">
<code class="descclassname">latools.helpers.process_fns.</code><code class="descname">expdecay_despike</code><span class="sig-paren">(</span><em>sig</em>, <em>expdecay_coef</em>, <em>tstep</em>, <em>maxiter=3</em>, <em>silent=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/process_fns.html#expdecay_despike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.process_fns.expdecay_despike" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply exponential decay filter to remove unrealistically low values.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">THERE’S SOMETHING WRONG WITH THIS FUNCTION. REMOVES TOO MUCH DATA!</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>exponent</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – Exponent used in filter</li>
<li><strong>tstep</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The time increment between data points.</li>
<li><strong>maxiter</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The maximum number of iterations to
apply the filter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.process_fns.noise_despike">
<code class="descclassname">latools.helpers.process_fns.</code><code class="descname">noise_despike</code><span class="sig-paren">(</span><em>sig</em>, <em>win=3</em>, <em>nlim=24.0</em>, <em>maxiter=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/process_fns.html#noise_despike"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.process_fns.noise_despike" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply standard deviation filter to remove anomalous values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window used to calculate rolling statistics.</li>
<li><strong>nlim</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The number of standard deviations above the rolling
mean above which data are considered outliers.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.process_fns.read_data">
<code class="descclassname">latools.helpers.process_fns.</code><code class="descname">read_data</code><span class="sig-paren">(</span><em>data_file</em>, <em>dataformat</em>, <em>name_mode</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/process_fns.html#read_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.process_fns.read_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data_file described by a dataformat dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_file</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Path to data file, including extension.</li>
<li><strong>dataformat</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – A dataformat dict, see example below.</li>
<li><strong>name_mode</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – How to identyfy sample names. If ‘file_names’ uses the
input name of the file, stripped of the extension. If
‘metadata_names’ uses the ‘name’ attribute of the ‘meta’
sub-dictionary in dataformat. If any other str, uses this
str as the sample name.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;&gt;</span>
<span class="go">{&#39;genfromtext_args&#39;: {&#39;delimiter&#39;: &#39;,&#39;,</span>
<span class="go">                      &#39;skip_header&#39;: 4},  # passed directly to np.genfromtxt</span>
<span class="go"> &#39;column_id&#39;: {&#39;name_row&#39;: 3,  # which row contains the column names</span>
<span class="go">               &#39;delimiter&#39;: &#39;,&#39;,  # delimeter between column names</span>
<span class="go">               &#39;timecolumn&#39;: 0,  # which column contains the &#39;time&#39; variable</span>
<span class="go">               &#39;pattern&#39;: &#39;([A-z]{1,2}[0-9]{1,3})&#39;},  # a regex pattern which captures the column names</span>
<span class="go"> &#39;meta_regex&#39;: {  # a dict of (line_no: ([descriptors], [regexs])) pairs</span>
<span class="go">                0: ([&#39;path&#39;], &#39;(.*)&#39;),</span>
<span class="go">                2: ([&#39;date&#39;, &#39;method&#39;],  # MUST include date</span>
<span class="go">                 &#39;([A-Z][a-z]+ [0-9]+ [0-9]{4}[ ]+[0-9:]+ [amp]+).* ([A-z0-9]+\.m)&#39;)</span>
<span class="go">               }</span>
<span class="go">}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>sample, analytes, data, meta</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-latools.helpers.stat_fns"></span><dl class="function">
<dt id="latools.helpers.stat_fns.H15_mean">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">H15_mean</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#H15_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.H15_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Huber (H15) Robust mean of x.</p>
<dl class="docutils">
<dt>For details, see:</dt>
<dd><a class="reference external" href="http://www.cscjp.co.jp/fera/document/ANALYSTVol114Decpgs1693-97_1989.pdf">http://www.cscjp.co.jp/fera/document/ANALYSTVol114Decpgs1693-97_1989.pdf</a>
<a class="reference external" href="http://www.rsc.org/images/robust-statistics-technical-brief-6_tcm18-214850.pdf">http://www.rsc.org/images/robust-statistics-technical-brief-6_tcm18-214850.pdf</a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.H15_se">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">H15_se</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#H15_se"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.H15_se" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Huber (H15) Robust standard deviation of x.</p>
<dl class="docutils">
<dt>For details, see:</dt>
<dd><a class="reference external" href="http://www.cscjp.co.jp/fera/document/ANALYSTVol114Decpgs1693-97_1989.pdf">http://www.cscjp.co.jp/fera/document/ANALYSTVol114Decpgs1693-97_1989.pdf</a>
<a class="reference external" href="http://www.rsc.org/images/robust-statistics-technical-brief-6_tcm18-214850.pdf">http://www.rsc.org/images/robust-statistics-technical-brief-6_tcm18-214850.pdf</a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.H15_std">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">H15_std</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#H15_std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.H15_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Huber (H15) Robust standard deviation of x.</p>
<dl class="docutils">
<dt>For details, see:</dt>
<dd><a class="reference external" href="http://www.cscjp.co.jp/fera/document/ANALYSTVol114Decpgs1693-97_1989.pdf">http://www.cscjp.co.jp/fera/document/ANALYSTVol114Decpgs1693-97_1989.pdf</a>
<a class="reference external" href="http://www.rsc.org/images/robust-statistics-technical-brief-6_tcm18-214850.pdf">http://www.rsc.org/images/robust-statistics-technical-brief-6_tcm18-214850.pdf</a></dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.R2calc">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">R2calc</code><span class="sig-paren">(</span><em>meas</em>, <em>model</em>, <em>force_zero=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#R2calc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.R2calc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.gauss">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">gauss</code><span class="sig-paren">(</span><em>x</em>, <em>*p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#gauss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array_like</em>) – Independent variable.</li>
<li><strong>*p</strong> (<em>parameters unpacked to A</em><em>, </em><em>mu</em><em>, </em><em>sigma</em>) – A = amplitude, mu = centre, sigma = width</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">gaussian descriped by <a href="#id1"><span class="problematic" id="id2">*</span></a>p.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array_like</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.gauss_weighted_stats">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">gauss_weighted_stats</code><span class="sig-paren">(</span><em>x</em>, <em>yarray</em>, <em>x_new</em>, <em>fwhm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#gauss_weighted_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.gauss_weighted_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate gaussian weigted moving mean, SD and SE.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>array-like</em>) – The independent variable</li>
<li><strong>yarray</strong> (<em>(</em><a class="reference internal" href="#latools.D_obj.filt.n" title="latools.D_obj.filt.n"><em>n</em></a><em>,</em><em>m</em><em>) </em><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) – Where n = x.size, and m is the number of
dependent variables to smooth.</li>
<li><strong>x_new</strong> (<em>array-like</em>) – The new x-scale to interpolate the data</li>
<li><strong>fwhm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – FWHM of the gaussian kernel.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>(mean, std, se)</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.nominal_values">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">nominal_values</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#nominal_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.nominal_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.std_devs">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">std_devs</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#std_devs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.std_devs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.stderr">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">stderr</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#stderr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.stderr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the standard error of a.</p>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.stat_fns.unpack_uncertainties">
<code class="descclassname">latools.helpers.stat_fns.</code><code class="descname">unpack_uncertainties</code><span class="sig-paren">(</span><em>uarray</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/stat_fns.html#unpack_uncertainties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.stat_fns.unpack_uncertainties" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to unpack nominal values and uncertainties from an
<code class="docutils literal"><span class="pre">uncertainties.uarray</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(nominal_values, std_devs)</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-latools.helpers.plot"></span><dl class="function">
<dt id="latools.helpers.plot.autorange_plot">
<code class="descclassname">latools.helpers.plot.</code><code class="descname">autorange_plot</code><span class="sig-paren">(</span><em>t</em>, <em>sig</em>, <em>gwin=7</em>, <em>swin=None</em>, <em>win=30</em>, <em>on_mult=(1.5</em>, <em>1.0)</em>, <em>off_mult=(1.0</em>, <em>1.5)</em>, <em>nbin=10</em>, <em>thresh=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/plot.html#autorange_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.plot.autorange_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for visualising the autorange mechanism.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>array-like</em>) – Independent variable (usually time).</li>
<li><strong>sig</strong> (<em>array-like</em>) – Dependent signal, with distinctive ‘on’ and ‘off’ regions.</li>
<li><strong>gwin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window used for calculating first derivative.
Defaults to 7.</li>
<li><strong>swin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The window ised for signal smoothing. If None, gwin // 2.</li>
<li><strong>win</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The width (c +/- win) of the transition data subsets.
Defaults to 20.</li>
<li><strong>and off_mult</strong> (<em>on_mult</em>) – Control the width of the excluded transition regions, which is defined
relative to the peak full-width-half-maximum (FWHM) of the transition
gradient. The region n * FHWM below the transition, and m * FWHM above
the tranision will be excluded, where (n, m) are specified in <cite>on_mult</cite>
and <cite>off_mult</cite>.
<cite>on_mult</cite> and <cite>off_mult</cite> apply to the off-on and on-off transitions,
respectively.
Defaults to (1.5, 1) and (1, 1.5).</li>
<li><strong>nbin</strong> (<em>ind</em>) – Used to calculate the number of bins in the data histogram.
bins = len(sig) // nbin</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">fig, axes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.plot.calibration_plot">
<code class="descclassname">latools.helpers.plot.</code><code class="descname">calibration_plot</code><span class="sig-paren">(</span><em>self</em>, <em>analytes=None</em>, <em>datarange=True</em>, <em>loglog=False</em>, <em>save=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/plot.html#calibration_plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.plot.calibration_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the calibration lines between measured and known SRM values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>datarange</strong> (<em>boolean</em>) – Whether or not to show the distribution of the measured data
alongside the calibration curve.</li>
<li><strong>loglog</strong> (<em>boolean</em>) – Whether or not to plot the data on a log - log scale. This is
useful if you have two low standards very close together,
and want to check whether your data are between them, or
below them.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.plot.crossplot">
<code class="descclassname">latools.helpers.plot.</code><code class="descname">crossplot</code><span class="sig-paren">(</span><em>dat</em>, <em>keys=None</em>, <em>lognorm=True</em>, <em>bins=25</em>, <em>figsize=(12</em>, <em>12)</em>, <em>colourful=True</em>, <em>focus_stage=None</em>, <em>denominator=None</em>, <em>mode='hist2d'</em>, <em>cmap=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/plot.html#crossplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.plot.crossplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes against each other.</p>
<p>The number of plots is n**2 - n, where n = len(keys).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>keys</strong> (<em>optional</em><em>, </em><em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – The analyte(s) to plot. Defaults to all analytes.</li>
<li><strong>lognorm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Whether or not to log normalise the colour scale
of the 2D histogram.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of bins in the 2D histogram.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.plot.filter_report">
<code class="descclassname">latools.helpers.plot.</code><code class="descname">filter_report</code><span class="sig-paren">(</span><em>Data</em>, <em>filt=None</em>, <em>analytes=None</em>, <em>savedir=None</em>, <em>nbin=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/plot.html#filter_report"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.plot.filter_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualise effect of data filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Exact or partial name of filter to plot. Supports
partial matching. i.e. if ‘cluster’ is specified, all
filters with ‘cluster’ in the name will be plotted.
Defaults to all filters.</li>
<li><strong>analyte</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Name of analyte to plot.</li>
<li><strong>save</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – file path to save the plot</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.plot.histograms">
<code class="descclassname">latools.helpers.plot.</code><code class="descname">histograms</code><span class="sig-paren">(</span><em>dat</em>, <em>keys=None</em>, <em>bins=25</em>, <em>logy=False</em>, <em>cmap=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/plot.html#histograms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.plot.histograms" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot histograms of all items in dat.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dat</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Data in {key: array} pairs.</li>
<li><strong>keys</strong> (<em>arra-like</em>) – The keys in dat that you want to plot. If None,
all are plotted.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) – The number of bins in each histogram (default = 25)</li>
<li><strong>logy</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – If true, y axis is a log scale.</li>
<li><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – The colours that the different items should be. If None,
all are grey.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">fig, axes</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="latools.helpers.plot.tplot">
<code class="descclassname">latools.helpers.plot.</code><code class="descname">tplot</code><span class="sig-paren">(</span><em>self, analytes=None, figsize=[10, 4], scale='log', filt=None, ranges=False, stats=False, stat='nanmean', err='nanstd', interactive=False, focus_stage=None, err_envelope=False, ax=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/latools/helpers/plot.html#tplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#latools.helpers.plot.tplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes as a function of Time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>analytes</strong> (<em>array_like</em>) – list of strings containing names of analytes to plot.
None = all analytes.</li>
<li><strong>figsize</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)"><em>tuple</em></a>) – size of final figure.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/constants.html#None" title="(in Python v2.7)"><em>None</em></a>) – ‘log’ = plot data on log scale</li>
<li><strong>filt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – False: plot unfiltered data.
True: plot filtered data over unfiltered data.
str: apply filter key to all analytes
dict: apply key to each analyte in dict. Must contain all
analytes plotted. Can use self.filt.keydict.</li>
<li><strong>ranges</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – show signal/background regions.</li>
<li><strong>stats</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – plot average and error of each trace, as specified by <cite>stat</cite> and
<cite>err</cite>.</li>
<li><strong>stat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – average statistic to plot.</li>
<li><strong>err</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – error statistic to plot.</li>
<li><strong>interactive</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Make the plot interactive.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">figure, axis</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="users/advanced/srm-file.html" class="btn btn-neutral" title="The SRM file" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Oscar Branson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>