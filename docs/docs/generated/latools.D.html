

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>latools.D &mdash; latools 0.2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="latools 0.2.0 documentation" href="../../index.html"/>
        <link rel="up" title="Latools Documentation" href="../index.html"/>
        <link rel="prev" title="Latools Documentation" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> latools
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../users/index.html">User Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Latools Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#classes">Classes</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">latools.D</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">latools</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Latools Documentation</a> &raquo;</li>
      
    <li>latools.D</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/docs/generated/latools.D.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="latools-d">
<h1>latools.D<a class="headerlink" href="#latools-d" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="latools.D">
<em class="property">class </em><code class="descclassname">latools.</code><code class="descname">D</code><span class="sig-paren">(</span><em>data_file</em>, <em>dataformat=None</em>, <em>errorhunt=False</em>, <em>cmap=None</em>, <em>internal_standard='Ca43'</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Container for data from a single laser ablation analysis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data_file</strong> : str</p>
<blockquote>
<div><p>The path to a data file.</p>
</div></blockquote>
<p><strong>errorhunt</strong> : bool</p>
<blockquote>
<div><p>Whether or not to print each data file name before
import. This is useful for tracing which data file
is causing the import to fail.</p>
</div></blockquote>
<p><strong>dataformat</strong> : str or dict</p>
<blockquote class="last">
<div><p>Either a path to a data format file, or a
dataformat dict. See documentation for more details.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>sample</td>
<td>(str) Sample name.</td>
</tr>
<tr class="row-even"><td>meta</td>
<td>(dict) Metadata extracted from the csv header. Contents varies, depending on your <cite>dataformat</cite>.</td>
</tr>
<tr class="row-odd"><td>analytes</td>
<td>(array_like) A list of analytes measured.</td>
</tr>
<tr class="row-even"><td>data</td>
<td>(dict) A dictionary containing the raw data, and modified data from each processing stage. Entries can be: rawdata: created during initialisation. despiked: created by <cite>despike</cite> signal: created by <cite>autorange</cite> background: created by <cite>autorange</cite> bkgsub: created by <cite>bkg_correct</cite> ratios: created by <cite>ratio</cite> calibrated: created by <cite>calibrate</cite></td>
</tr>
<tr class="row-odd"><td>focus</td>
<td>(dict) A dictionary containing one item from <cite>data</cite>. This is the currently &#8216;active&#8217; data that processing functions will work on. This data is also directly available as class attributes with the same names as the items in <cite>focus</cite>.</td>
</tr>
<tr class="row-even"><td>focus_stage</td>
<td>(str) Identifies which item in <cite>data</cite> is currently assigned to <cite>focus</cite>.</td>
</tr>
<tr class="row-odd"><td>cmap</td>
<td>(dict) A dictionary containing hex colour strings corresponding to each measured analyte.</td>
</tr>
<tr class="row-even"><td>bkg, sig, trn</td>
<td>(array_like, bool) Boolean arrays identifying signal, background and transition regions. Created by <cite>autorange</cite>.</td>
</tr>
<tr class="row-odd"><td>bkgrng, sigrng, trnrng</td>
<td>(array_like) An array of shape (n, 2) containing pairs of values that describe the Time limits of background, signal and transition regions.</td>
</tr>
<tr class="row-even"><td>ns</td>
<td>(array_like) An integer array the same length as the data, where each analysis spot is labelled with a unique number. Used for separating analysys spots when calculating sample statistics.</td>
</tr>
<tr class="row-odd"><td>filt</td>
<td>(filt object) An object for storing, selecting and creating data filters.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.autorange" title="latools.D.autorange"><code class="xref py py-obj docutils literal"><span class="pre">autorange</span></code></a>([analyte,&nbsp;gwin,&nbsp;win,&nbsp;smwin,&nbsp;conf,&nbsp;...])</td>
<td>Automatically separates signal and background data regions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.calibrate" title="latools.D.calibrate"><code class="xref py py-obj docutils literal"><span class="pre">calibrate</span></code></a>(calib_fns,&nbsp;calib_params[,&nbsp;...])</td>
<td>Apply calibration to data.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.cluster_DBSCAN" title="latools.D.cluster_DBSCAN"><code class="xref py py-obj docutils literal"><span class="pre">cluster_DBSCAN</span></code></a>(data[,&nbsp;eps,&nbsp;min_samples,&nbsp;...])</td>
<td>Identify clusters using DBSCAN algorithm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.cluster_kmeans" title="latools.D.cluster_kmeans"><code class="xref py py-obj docutils literal"><span class="pre">cluster_kmeans</span></code></a>(data,&nbsp;n_clusters)</td>
<td>Identify clusters using K - Means algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.cluster_meanshift" title="latools.D.cluster_meanshift"><code class="xref py py-obj docutils literal"><span class="pre">cluster_meanshift</span></code></a>(data[,&nbsp;bandwidth,&nbsp;bin_seeding])</td>
<td>Identify clusters using Meanshift algorithm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.crossplot" title="latools.D.crossplot"><code class="xref py py-obj docutils literal"><span class="pre">crossplot</span></code></a>([analytes,&nbsp;bins,&nbsp;lognorm,&nbsp;filt])</td>
<td>Plot analytes against each other.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.despike" title="latools.D.despike"><code class="xref py py-obj docutils literal"><span class="pre">despike</span></code></a>([expdecay_despiker,&nbsp;exponent,&nbsp;...])</td>
<td>Applies expdecay_despiker and noise_despiker to data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.expdecay_despiker" title="latools.D.expdecay_despiker"><code class="xref py py-obj docutils literal"><span class="pre">expdecay_despiker</span></code></a>([exponent,&nbsp;tstep])</td>
<td>Apply exponential decay filter to remove unrealistically low values.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.filt_report" title="latools.D.filt_report"><code class="xref py py-obj docutils literal"><span class="pre">filt_report</span></code></a>([filt,&nbsp;analytes,&nbsp;savedir])</td>
<td>Visualise effect of data filters.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.filter_clustering" title="latools.D.filter_clustering"><code class="xref py py-obj docutils literal"><span class="pre">filter_clustering</span></code></a>(analytes[,&nbsp;filt,&nbsp;...])</td>
<td>Applies an n - dimensional clustering filter to the data.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.filter_correlation" title="latools.D.filter_correlation"><code class="xref py py-obj docutils literal"><span class="pre">filter_correlation</span></code></a>(x_analyte,&nbsp;y_analyte[,&nbsp;...])</td>
<td>Apply correlation filter.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.filter_distribution" title="latools.D.filter_distribution"><code class="xref py py-obj docutils literal"><span class="pre">filter_distribution</span></code></a>(analytes[,&nbsp;binwidth,&nbsp;...])</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.filter_threshold" title="latools.D.filter_threshold"><code class="xref py py-obj docutils literal"><span class="pre">filter_threshold</span></code></a>(analyte,&nbsp;threshold[,&nbsp;filt])</td>
<td>Apply threshold filter.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.findmins" title="latools.D.findmins"><code class="xref py py-obj docutils literal"><span class="pre">findmins</span></code></a>(x,&nbsp;y)</td>
<td>Function to find local minima.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.get_params" title="latools.D.get_params"><code class="xref py py-obj docutils literal"><span class="pre">get_params</span></code></a>()</td>
<td>Returns paramters used to process data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.mkrngs" title="latools.D.mkrngs"><code class="xref py py-obj docutils literal"><span class="pre">mkrngs</span></code></a>()</td>
<td>Transform boolean arrays into list of limit pairs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.ratio" title="latools.D.ratio"><code class="xref py py-obj docutils literal"><span class="pre">ratio</span></code></a>([internal_standard,&nbsp;focus])</td>
<td>Divide all analytes by a specified internal_standard analyte.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.sample_stats" title="latools.D.sample_stats"><code class="xref py py-obj docutils literal"><span class="pre">sample_stats</span></code></a>([analytes,&nbsp;filt,&nbsp;stat_fns,&nbsp;...])</td>
<td>TODO: WORK OUT HOW TO HANDLE ERRORS PROPERLY!</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.setfocus" title="latools.D.setfocus"><code class="xref py py-obj docutils literal"><span class="pre">setfocus</span></code></a>(focus)</td>
<td>Set the &#8216;focus&#8217; attribute of the data file.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.noise_despiker" title="latools.D.noise_despiker"><code class="xref py py-obj docutils literal"><span class="pre">noise_despiker</span></code></a>([win,&nbsp;nlim])</td>
<td>Apply standard deviation filter to remove anomalous high values.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.tplot" title="latools.D.tplot"><code class="xref py py-obj docutils literal"><span class="pre">tplot</span></code></a>([analytes,&nbsp;figsize,&nbsp;scale,&nbsp;filt,&nbsp;...])</td>
<td>Plot analytes as a function of Time.</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="58%" />
<col width="42%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>bkg_correct</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>bkgrange</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>fastgrad</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>findlower</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>findupper</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>gauss</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>gauss_inv</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>makerangebools</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>rolling_window</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>separate</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>sigrange</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="latools.D.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>data_file</em>, <em>dataformat=None</em>, <em>errorhunt=False</em>, <em>cmap=None</em>, <em>internal_standard='Ca43'</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.__init__" title="latools.D.__init__"><code class="xref py py-obj docutils literal"><span class="pre">__init__</span></code></a>(data_file[,&nbsp;dataformat,&nbsp;errorhunt,&nbsp;...])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.ablation_times" title="latools.D.ablation_times"><code class="xref py py-obj docutils literal"><span class="pre">ablation_times</span></code></a>()</td>
<td>Function for calculating the ablation time for each ablation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.autorange" title="latools.D.autorange"><code class="xref py py-obj docutils literal"><span class="pre">autorange</span></code></a>([analyte,&nbsp;gwin,&nbsp;win,&nbsp;smwin,&nbsp;conf,&nbsp;...])</td>
<td>Automatically separates signal and background data regions.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.bkg_subtract" title="latools.D.bkg_subtract"><code class="xref py py-obj docutils literal"><span class="pre">bkg_subtract</span></code></a>(analyte,&nbsp;bkg[,&nbsp;ind])</td>
<td>Subtract provided background from signal (focus stage).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.calibrate" title="latools.D.calibrate"><code class="xref py py-obj docutils literal"><span class="pre">calibrate</span></code></a>(calib_fns,&nbsp;calib_params[,&nbsp;...])</td>
<td>Apply calibration to data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.cluster_DBSCAN" title="latools.D.cluster_DBSCAN"><code class="xref py py-obj docutils literal"><span class="pre">cluster_DBSCAN</span></code></a>(data[,&nbsp;eps,&nbsp;min_samples,&nbsp;...])</td>
<td>Identify clusters using DBSCAN algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.cluster_kmeans" title="latools.D.cluster_kmeans"><code class="xref py py-obj docutils literal"><span class="pre">cluster_kmeans</span></code></a>(data,&nbsp;n_clusters)</td>
<td>Identify clusters using K - Means algorithm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.cluster_meanshift" title="latools.D.cluster_meanshift"><code class="xref py py-obj docutils literal"><span class="pre">cluster_meanshift</span></code></a>(data[,&nbsp;bandwidth,&nbsp;bin_seeding])</td>
<td>Identify clusters using Meanshift algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.crossplot" title="latools.D.crossplot"><code class="xref py py-obj docutils literal"><span class="pre">crossplot</span></code></a>([analytes,&nbsp;bins,&nbsp;lognorm,&nbsp;filt])</td>
<td>Plot analytes against each other.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.despike" title="latools.D.despike"><code class="xref py py-obj docutils literal"><span class="pre">despike</span></code></a>([expdecay_despiker,&nbsp;exponent,&nbsp;...])</td>
<td>Applies expdecay_despiker and noise_despiker to data.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.drift_params" title="latools.D.drift_params"><code class="xref py py-obj docutils literal"><span class="pre">drift_params</span></code></a>(pout,&nbsp;a)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.expdecay_despiker" title="latools.D.expdecay_despiker"><code class="xref py py-obj docutils literal"><span class="pre">expdecay_despiker</span></code></a>([exponent,&nbsp;tstep])</td>
<td>Apply exponential decay filter to remove unrealistically low values.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.filt_report" title="latools.D.filt_report"><code class="xref py py-obj docutils literal"><span class="pre">filt_report</span></code></a>([filt,&nbsp;analytes,&nbsp;savedir])</td>
<td>Visualise effect of data filters.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.filter_clustering" title="latools.D.filter_clustering"><code class="xref py py-obj docutils literal"><span class="pre">filter_clustering</span></code></a>(analytes[,&nbsp;filt,&nbsp;...])</td>
<td>Applies an n - dimensional clustering filter to the data.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.filter_correlation" title="latools.D.filter_correlation"><code class="xref py py-obj docutils literal"><span class="pre">filter_correlation</span></code></a>(x_analyte,&nbsp;y_analyte[,&nbsp;...])</td>
<td>Apply correlation filter.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.filter_distribution" title="latools.D.filter_distribution"><code class="xref py py-obj docutils literal"><span class="pre">filter_distribution</span></code></a>(analytes[,&nbsp;binwidth,&nbsp;...])</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.filter_threshold" title="latools.D.filter_threshold"><code class="xref py py-obj docutils literal"><span class="pre">filter_threshold</span></code></a>(analyte,&nbsp;threshold[,&nbsp;filt])</td>
<td>Apply threshold filter.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.findmins" title="latools.D.findmins"><code class="xref py py-obj docutils literal"><span class="pre">findmins</span></code></a>(x,&nbsp;y)</td>
<td>Function to find local minima.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.get_params" title="latools.D.get_params"><code class="xref py py-obj docutils literal"><span class="pre">get_params</span></code></a>()</td>
<td>Returns paramters used to process data.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.mkrngs" title="latools.D.mkrngs"><code class="xref py py-obj docutils literal"><span class="pre">mkrngs</span></code></a>()</td>
<td>Transform boolean arrays into list of limit pairs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.noise_despiker" title="latools.D.noise_despiker"><code class="xref py py-obj docutils literal"><span class="pre">noise_despiker</span></code></a>([win,&nbsp;nlim])</td>
<td>Apply standard deviation filter to remove anomalous high values.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.ratio" title="latools.D.ratio"><code class="xref py py-obj docutils literal"><span class="pre">ratio</span></code></a>([internal_standard,&nbsp;focus])</td>
<td>Divide all analytes by a specified internal_standard analyte.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.sample_stats" title="latools.D.sample_stats"><code class="xref py py-obj docutils literal"><span class="pre">sample_stats</span></code></a>([analytes,&nbsp;filt,&nbsp;stat_fns,&nbsp;...])</td>
<td>TODO: WORK OUT HOW TO HANDLE ERRORS PROPERLY!</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#latools.D.setfocus" title="latools.D.setfocus"><code class="xref py py-obj docutils literal"><span class="pre">setfocus</span></code></a>(focus)</td>
<td>Set the &#8216;focus&#8217; attribute of the data file.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#latools.D.tplot" title="latools.D.tplot"><code class="xref py py-obj docutils literal"><span class="pre">tplot</span></code></a>([analytes,&nbsp;figsize,&nbsp;scale,&nbsp;filt,&nbsp;...])</td>
<td>Plot analytes as a function of Time.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="latools.D.ablation_times">
<code class="descname">ablation_times</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.ablation_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for calculating the ablation time for each
ablation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict of times for each ablation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.autorange">
<code class="descname">autorange</code><span class="sig-paren">(</span><em>analyte=None</em>, <em>gwin=11</em>, <em>win=40</em>, <em>smwin=5</em>, <em>conf=0.01</em>, <em>on_mult=(1.0</em>, <em>1.0)</em>, <em>off_mult=(1.0</em>, <em>1.0)</em>, <em>d_mult=1.2</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.autorange" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Automatically separates signal and background data regions.</div></blockquote>
<p>Automatically detect signal and background regions in the laser
data, based on the behaviour of a single analyte. The analyte used
should be abundant and homogenous in the sample.</p>
<p>Step 1: Thresholding
The background signal is determined using a gaussian kernel density
estimator (kde) of all the data. Under normal circumstances, this
kde should find two distinct data distributions, corresponding to
&#8216;signal&#8217; and &#8216;background&#8217;. The minima between these two distributions
is taken as a rough threshold to identify signal and background
regions. Any point where the trace crosses this thrshold is identified
as a &#8216;transition&#8217;.</p>
<p>Step 2: Transition Removal
The width of the transition regions between signal and background are
then determined, and the transitions are excluded from analysis. The
width of the transitions is determined by fitting a gaussian to the
smoothed first derivative of the analyte trace, and determining its
width at a point where the gaussian intensity is at at <cite>conf</cite> time the
gaussian maximum. These gaussians are fit to subsets of the data
centered around the transitions regions determined in Step 1, +/- <cite>win</cite>
data points. The peak is further isolated by finding the minima and
maxima of a second derivative within this window, and the gaussian is
fit to the isolated peak.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>analyte</strong> : str</p>
<blockquote>
<div><p>The analyte that autorange should consider. For best results,
choose an analyte that is present homogeneously in high
concentrations.</p>
</div></blockquote>
<p><strong>gwin</strong> : int</p>
<blockquote>
<div><p>The smoothing window used for calculating the first derivative.
Must be odd.</p>
</div></blockquote>
<p><strong>win</strong> : int</p>
<blockquote>
<div><p>Determines the width (c +/- win) of the transition data subsets.</p>
</div></blockquote>
<p><strong>smwin</strong> : int</p>
<blockquote>
<div><p>The smoothing window used for calculating the second derivative.
Must be odd.</p>
</div></blockquote>
<p><strong>on_mult and off_mult</strong> : tuple, len=2</p>
<blockquote>
<div><p>Factors to control the width of the excluded transition regions.
A region n times the full - width - half - maximum of the transition
gradient will be removed either side of the transition center.
<cite>on_mult</cite> and <cite>off_mult</cite> refer to the laser - on and laser - off
transitions, respectively. See manual for full explanation.
Defaults to (1.5, 1) and (1, 1.5).</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.bkg_subtract">
<code class="descname">bkg_subtract</code><span class="sig-paren">(</span><em>analyte</em>, <em>bkg</em>, <em>ind=None</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.bkg_subtract" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract provided background from signal (focus stage).</p>
<p>Results is saved in new &#8216;bkgsub&#8217; focus stage</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.calibrate">
<code class="descname">calibrate</code><span class="sig-paren">(</span><em>calib_fns</em>, <em>calib_params</em>, <em>analytes=None</em>, <em>drift_correct=False</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.calibrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply calibration to data.</p>
<p>The <cite>calib_dict</cite> must be calculated at the <cite>analyse</cite> level,
and passed to this calibrate function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>calib_dict</strong> : dict</p>
<blockquote>
<div><p>A dict of calibration values to apply to each analyte.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.cluster_DBSCAN">
<code class="descname">cluster_DBSCAN</code><span class="sig-paren">(</span><em>data</em>, <em>eps=None</em>, <em>min_samples=None</em>, <em>n_clusters=None</em>, <em>maxiter=200</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.cluster_DBSCAN" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify clusters using DBSCAN algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array_like</p>
<blockquote>
<div><p>array of size [n_samples, n_features].</p>
</div></blockquote>
<p><strong>eps</strong> : float</p>
<blockquote>
<div><p>The minimum &#8216;distance&#8217; points must be apart for them to be in the
same cluster. Defaults to 0.3. Note: If the data are normalised
(they should be for DBSCAN) this is in terms of total sample
variance.  Normalised data have a mean of 0 and a variance of 1.</p>
</div></blockquote>
<p><strong>min_samples</strong> : int</p>
<blockquote>
<div><p>The minimum number of samples within distance <cite>eps</cite> required
to be considered as an independent cluster.</p>
</div></blockquote>
<p><strong>n_clusters</strong> : int</p>
<blockquote>
<div><p>The number of clusters expected. If specified, <cite>eps</cite> will be
incrementally reduced until the expected number of clusters is
found.</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>The maximum number of iterations DBSCAN will run.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict</p>
<blockquote class="last">
<div><p>boolean array for each identified cluster and core samples.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.cluster_kmeans">
<code class="descname">cluster_kmeans</code><span class="sig-paren">(</span><em>data</em>, <em>n_clusters</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.cluster_kmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify clusters using K - Means algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array_like</p>
<blockquote>
<div><p>array of size [n_samples, n_features].</p>
</div></blockquote>
<p><strong>n_clusters</strong> : int</p>
<blockquote>
<div><p>The number of clusters expected in the data.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict</p>
<blockquote class="last">
<div><p>boolean array for each identified cluster.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.cluster_meanshift">
<code class="descname">cluster_meanshift</code><span class="sig-paren">(</span><em>data</em>, <em>bandwidth=None</em>, <em>bin_seeding=False</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.cluster_meanshift" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify clusters using Meanshift algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array_like</p>
<blockquote>
<div><p>array of size [n_samples, n_features].</p>
</div></blockquote>
<p><strong>bandwidth</strong> : float or None</p>
<blockquote>
<div><p>If None, bandwidth is estimated automatically using
sklean.cluster.estimate_bandwidth</p>
</div></blockquote>
<p><strong>bin_seeding</strong> : bool</p>
<blockquote>
<div><p>Setting this option to True will speed up the algorithm.
See sklearn documentation for full description.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict</p>
<blockquote class="last">
<div><p>boolean array for each identified cluster.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.crossplot">
<code class="descname">crossplot</code><span class="sig-paren">(</span><em>analytes=None</em>, <em>bins=25</em>, <em>lognorm=True</em>, <em>filt=True</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.crossplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes against each other.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>analytes</strong> : optional, array_like or str</p>
<blockquote>
<div><p>The analyte(s) to plot. Defaults to all analytes.</p>
</div></blockquote>
<p><strong>lognorm</strong> : bool</p>
<blockquote>
<div><p>Whether or not to log normalise the colour scale
of the 2D histogram.</p>
</div></blockquote>
<p><strong>bins</strong> : int</p>
<blockquote>
<div><p>The number of bins in the 2D histogram.</p>
</div></blockquote>
<p><strong>filt</strong> : str, dict or bool</p>
<blockquote>
<div><p>Either logical filter expression contained in a str,
a dict of expressions specifying the filter string to
use for each analyte or a boolean. Passed to <cite>grab_filt</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.despike">
<code class="descname">despike</code><span class="sig-paren">(</span><em>expdecay_despiker=True</em>, <em>exponent=None</em>, <em>tstep=None</em>, <em>noise_despiker=True</em>, <em>win=3</em>, <em>nlim=12.0</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.despike" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies expdecay_despiker and noise_despiker to data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>expdecay_despiker</strong> : bool</p>
<blockquote>
<div><p>Whether or not to apply the exponential decay filter.</p>
</div></blockquote>
<p><strong>exponent</strong> : None or float</p>
<blockquote>
<div><p>The exponent for the exponential decay filter. If None,
it is determined automatically using <cite>find_expocoef</cite>.</p>
</div></blockquote>
<p><strong>tstep</strong> : None or float</p>
<blockquote>
<div><p>The timeinterval between measurements. If None, it is
determined automatically from the Time variable.</p>
</div></blockquote>
<p><strong>noise_despiker</strong> : bool</p>
<blockquote>
<div><p>Whether or not to apply the standard deviation spike filter.</p>
</div></blockquote>
<p><strong>win</strong> : int</p>
<blockquote>
<div><p>The rolling window over which the spike filter calculates
the trace statistics.</p>
</div></blockquote>
<p><strong>nlim</strong> : float</p>
<blockquote>
<div><p>The number of standard deviations above the rolling mean
that data are excluded.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.drift_params">
<code class="descname">drift_params</code><span class="sig-paren">(</span><em>pout</em>, <em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.drift_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="latools.D.expdecay_despiker">
<code class="descname">expdecay_despiker</code><span class="sig-paren">(</span><em>exponent=None</em>, <em>tstep=None</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.expdecay_despiker" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply exponential decay filter to remove unrealistically low values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>exponent</strong> : float</p>
<blockquote>
<div><p>Expinent used in filter</p>
</div></blockquote>
<p><strong>tstep</strong> : float</p>
<blockquote>
<div><p>The time increment between data points.
Calculated from Time variable if None.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.filt_report">
<code class="descname">filt_report</code><span class="sig-paren">(</span><em>filt=None</em>, <em>analytes=None</em>, <em>savedir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.filt_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualise effect of data filters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filt</strong> : str</p>
<blockquote>
<div><p>Exact or partial name of filter to plot. Supports
partial matching. i.e. if &#8216;cluster&#8217; is specified, all
filters with &#8216;cluster&#8217; in the name will be plotted.
Defaults to all filters.</p>
</div></blockquote>
<p><strong>analyte</strong> : str</p>
<blockquote>
<div><p>Name of analyte to plot.</p>
</div></blockquote>
<p><strong>save</strong> : str</p>
<blockquote>
<div><p>file path to save the plot</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(fig, axes)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.filter_clustering">
<code class="descname">filter_clustering</code><span class="sig-paren">(</span><em>analytes</em>, <em>filt=False</em>, <em>normalise=True</em>, <em>method='meanshift'</em>, <em>include_time=False</em>, <em>sort=None</em>, <em>min_data=10</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.filter_clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies an n - dimensional clustering filter to the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>analytes</strong> : str</p>
<blockquote>
<div><p>The analyte(s) that the filter applies to.</p>
</div></blockquote>
<p><strong>filt</strong> : bool</p>
<blockquote>
<div><p>Whether or not to apply existing filters to the data before
calculating this filter.</p>
</div></blockquote>
<p><strong>normalise</strong> : bool</p>
<blockquote>
<div><p>Whether or not to normalise the data to zero mean and unit
variance. Reccomended if clustering based on more than 1 analyte.
Uses <cite>sklearn.preprocessing.scale</cite>.</p>
</div></blockquote>
<p><strong>method</strong> : str</p>
<blockquote>
<div><dl class="docutils">
<dt>Which clustering algorithm to use. Can be:</dt>
<dd><dl class="first docutils">
<dt>&#8216;meanshift&#8217;: The <cite>sklearn.cluster.MeanShift</cite> algorithm.</dt>
<dd><p class="first last">Automatically determines number of clusters
in data based on the <cite>bandwidth</cite> of expected
variation.</p>
</dd>
<dt>&#8216;kmeans&#8217;: The <cite>sklearn.cluster.KMeans</cite> algorithm. Determines</dt>
<dd><p class="first last">the characteristics of a known number of clusters
within the data. Must provide <cite>n_clusters</cite> to specify
the expected number of clusters.</p>
</dd>
<dt>&#8216;DBSCAN&#8217;: The <cite>sklearn.cluster.DBSCAN</cite> algorithm. Automatically</dt>
<dd><p class="first last">determines the number and characteristics of clusters
within the data based on the &#8216;connectivity&#8217; of the
data (i.e. how far apart each data point is in a
multi - dimensional parameter space). Requires you to
set <cite>eps</cite>, the minimum distance point must be from
another point to be considered in the same cluster,
and <cite>min_samples</cite>, the minimum number of points that
must be within the minimum distance for it to be
considered a cluster. It may also be run in automatic
mode by specifying <cite>n_clusters</cite> alongside
<cite>min_samples</cite>, where eps is decreased until the
desired number of clusters is obtained.</p>
</dd>
</dl>
<p class="last">For more information on these algorithms, refer to the
documentation.</p>
</dd>
</dl>
</div></blockquote>
<p><strong>include_time</strong> : bool</p>
<blockquote>
<div><p>Whether or not to include the Time variable in the clustering
analysis. Useful if you&#8217;re looking for spatially continuous
clusters in your data, i.e. this will identify each spot in your
analysis as an individual cluster.</p>
</div></blockquote>
<p><strong>sort</strong> : bool, str or array-like</p>
<blockquote>
<div><p>Whether or not to label the resulting clusters according to their
contents. If used, the cluster with the lowest values will be
labelled from 0, in order of increasing cluster mean value.analytes</p>
<blockquote>
<div><p>True: Sort by all analytes used to generate the cluster.
str: Sort by a single specified analyte
array-like: Sort by a number of specified analytes.</p>
</div></blockquote>
</div></blockquote>
<p><strong>min_data</strong> : int</p>
<blockquote>
<div><p>The minimum number of data points that should be considered by
the filter. Default = 10.</p>
</div></blockquote>
<p><strong>**kwargs</strong></p>
<blockquote>
<div><p>Parameters passed to the clustering algorithm specified by
<cite>method</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.filter_correlation">
<code class="descname">filter_correlation</code><span class="sig-paren">(</span><em>x_analyte</em>, <em>y_analyte</em>, <em>window=None</em>, <em>r_threshold=0.9</em>, <em>p_threshold=0.05</em>, <em>filt=True</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.filter_correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply correlation filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x_analyte, y_analyte</strong> : str</p>
<blockquote>
<div><p>The names of the x and y analytes to correlate.</p>
</div></blockquote>
<p><strong>window</strong> : int, None</p>
<blockquote>
<div><p>The rolling window used when calculating the correlation.</p>
</div></blockquote>
<p><strong>r_threshold</strong> : float</p>
<blockquote>
<div><p>The correlation index above which to exclude data.
Note: the absolute pearson R value is considered, so
negative correlations below -<cite>r_threshold</cite> will also
be excluded.</p>
</div></blockquote>
<p><strong>p_threshold</strong> : float</p>
<blockquote>
<div><p>The significant level below which data are excluded.</p>
</div></blockquote>
<p><strong>filt</strong> : bool</p>
<blockquote>
<div><p>Whether or not to apply existing filters to the data before
calculating this filter.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.filter_distribution">
<code class="descname">filter_distribution</code><span class="sig-paren">(</span><em>analytes</em>, <em>binwidth='scott'</em>, <em>filt=False</em>, <em>transform=None</em>, <em>min_data=10</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.filter_distribution" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>analytes</strong> : str or list</p>
<blockquote>
<div><p>The analyte that the filter applies to.</p>
</div></blockquote>
<p><strong>binwidth</strong> : str of float</p>
<blockquote>
<div><p>Specify the bin width of the kernel density estimator.
Passed to <cite>scipy.stats.gaussian_kde</cite>.
str: The method used to automatically estimate bin width.</p>
<blockquote>
<div><p>Can be &#8216;scott&#8217; or &#8216;silverman&#8217;.</p>
</div></blockquote>
<p>float: Manually specify the binwidth of the data.</p>
</div></blockquote>
<p><strong>filt</strong> : bool</p>
<blockquote>
<div><p>Whether or not to apply existing filters to the data before
calculating this filter.</p>
</div></blockquote>
<p><strong>transform</strong> : str</p>
<blockquote>
<div><p>If &#8216;log&#8217;, applies a log transform to the data before calculating
the distribution.</p>
</div></blockquote>
<p><strong>min_data</strong> : int</p>
<blockquote>
<div><p>The minimum number of data points that should be considered by
the filter. Default = 10.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.filter_threshold">
<code class="descname">filter_threshold</code><span class="sig-paren">(</span><em>analyte</em>, <em>threshold</em>, <em>filt=False</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.filter_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply threshold filter.</p>
<p>Generates threshold filters for the given analytes above and below
the specified threshold.</p>
<dl class="docutils">
<dt>Two filters are created with prefixes &#8216;_above&#8217; and &#8216;_below&#8217;.</dt>
<dd>&#8216;_above&#8217; keeps all the data above the threshold.
&#8216;_below&#8217; keeps all the data below the threshold.</dd>
</dl>
<p>i.e. to select data below the threshold value, you should turn the
&#8216;_above&#8217; filter off.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>analyte</strong> : TYPE</p>
<blockquote>
<div><p>Description of <cite>analyte</cite>.</p>
</div></blockquote>
<p><strong>threshold</strong> : TYPE</p>
<blockquote>
<div><p>Description of <cite>threshold</cite>.</p>
</div></blockquote>
<p><strong>filt</strong> : TYPE</p>
<blockquote>
<div><p>Description of <cite>filt</cite>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.findmins">
<code class="descname">findmins</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.findmins" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to find local minima.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x, y</strong> : array_like</p>
<blockquote>
<div><p>1D arrays of the independent (x) and dependent (y) variables.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array_like</p>
<blockquote class="last">
<div><p>Array of points in x where y has a local minimum.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns paramters used to process data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict</p>
<blockquote class="last">
<div><p>dict of analysis parameters</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.mkrngs">
<code class="descname">mkrngs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.mkrngs" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform boolean arrays into list of limit pairs.</p>
<p>Gets Time limits of signal/background boolean arrays and stores them as
sigrng and bkgrng arrays. These arrays can be saved by &#8216;save_ranges&#8217; in
the analyse object.</p>
</dd></dl>

<dl class="method">
<dt id="latools.D.noise_despiker">
<code class="descname">noise_despiker</code><span class="sig-paren">(</span><em>win=3</em>, <em>nlim=12.0</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.noise_despiker" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply standard deviation filter to remove anomalous high values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>win</strong> : int</p>
<blockquote>
<div><p>The window used to calculate rolling statistics.</p>
</div></blockquote>
<p><strong>nlim</strong> : float</p>
<blockquote>
<div><p>The number of standard deviations above the rolling
mean above which data are considered outliers.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.ratio">
<code class="descname">ratio</code><span class="sig-paren">(</span><em>internal_standard=None</em>, <em>focus='bkgsub'</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide all analytes by a specified internal_standard analyte.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>internal_standard</strong> : str</p>
<blockquote>
<div><p>The analyte used as the internal_standard.</p>
</div></blockquote>
<p><strong>focus</strong> : str</p>
<blockquote>
<div><p>The analysis stage to perform the ratio calculation on.
Defaults to &#8216;signal&#8217;.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.sample_stats">
<code class="descname">sample_stats</code><span class="sig-paren">(</span><em>analytes=None, filt=True, stat_fns=[&lt;function nanmean&gt;, &lt;function nanstd&gt;], eachtrace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.sample_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: WORK OUT HOW TO HANDLE ERRORS PROPERLY!</p>
<p>Calculate sample statistics</p>
<p>Returns samples, analytes, and arrays of statistics
of shape (samples, analytes). Statistics are calculated
from the &#8216;focus&#8217; data variable, so output depends on how
the data have been processed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>analytes</strong> : array_like</p>
<blockquote>
<div><p>List of analytes to calculate the statistic on</p>
</div></blockquote>
<p><strong>filt</strong> : bool or str</p>
<blockquote>
<div><dl class="docutils">
<dt>The filter to apply to the data when calculating sample statistics.</dt>
<dd><p class="first last">bool: True applies filter specified in filt.switches.
str: logical string specifying a partucular filter</p>
</dd>
</dl>
</div></blockquote>
<p><strong>stat_fns</strong> : array_like</p>
<blockquote>
<div><p>List of functions that take a single array_like input,
and return a single statistic. Function should be able
to cope with numpy NaN values.</p>
</div></blockquote>
<p><strong>eachtrace</strong> : bool</p>
<blockquote>
<div><p>True: per - ablation statistics
False: whole sample statistics</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.setfocus">
<code class="descname">setfocus</code><span class="sig-paren">(</span><em>focus</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.setfocus" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the &#8216;focus&#8217; attribute of the data file.</p>
<p>The &#8216;focus&#8217; attribute of the object points towards data from a
particular stage of analysis. It is used to identify the &#8216;working
stage&#8217; of the data. Processing functions operate on the &#8216;focus&#8217;
stage, so if steps are done out of sequence, things will break.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>focus</strong> : str</p>
<blockquote>
<div><dl class="docutils">
<dt>The name of the analysis stage desired:</dt>
<dd><dl class="first docutils">
<dt>&#8216;rawdata&#8217;: raw data, loaded from csv file when object</dt>
<dd><p class="first last">is initialised.</p>
</dd>
</dl>
<p>&#8216;despiked&#8217;: despiked data.
&#8216;signal&#8217;/&#8217;background&#8217;: isolated signal and background data,</p>
<blockquote>
<div><p>padded with np.nan. Created by self.separate, after
signal and background regions have been identified by
self.autorange.</p>
</div></blockquote>
<dl class="docutils">
<dt>&#8216;bkgsub&#8217;: background subtracted data, created by</dt>
<dd><p class="first last">self.bkg_correct</p>
</dd>
</dl>
<p>&#8216;ratios&#8217;: element ratio data, created by self.ratio.
&#8216;calibrated&#8217;: ratio data calibrated to standards, created by</p>
<blockquote class="last">
<div><p>self.calibrate.</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="latools.D.tplot">
<code class="descname">tplot</code><span class="sig-paren">(</span><em>analytes=None, figsize=[10, 4], scale=None, filt=None, ranges=False, stats=False, stat='nanmean', err='nanstd', interactive=False, focus_stage=None, err_envelope=False</em><span class="sig-paren">)</span><a class="headerlink" href="#latools.D.tplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot analytes as a function of Time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>analytes</strong> : array_like</p>
<blockquote>
<div><p>list of strings containing names of analytes to plot.
None = all analytes.</p>
</div></blockquote>
<p><strong>figsize</strong> : tuple</p>
<blockquote>
<div><p>size of final figure.</p>
</div></blockquote>
<p><strong>scale</strong> : str or None</p>
<blockquote>
<div><p>&#8216;log&#8217; = plot data on log scale</p>
</div></blockquote>
<p><strong>filt</strong> : bool, str or dict</p>
<blockquote>
<div><p>False: plot unfiltered data.
True: plot filtered data over unfiltered data.
str: apply filter key to all analytes
dict: apply key to each analyte in dict. Must contain all
analytes plotted. Can use self.filt.keydict.</p>
</div></blockquote>
<p><strong>ranges</strong> : bool</p>
<blockquote>
<div><p>show signal/background regions.</p>
</div></blockquote>
<p><strong>stats</strong> : bool</p>
<blockquote>
<div><p>plot average and error of each trace, as specified by <cite>stat</cite> and
<cite>err</cite>.</p>
</div></blockquote>
<p><strong>stat</strong> : str</p>
<blockquote>
<div><p>average statistic to plot.</p>
</div></blockquote>
<p><strong>err</strong> : str</p>
<blockquote>
<div><p>error statistic to plot.</p>
</div></blockquote>
<p><strong>interactive</strong> : bool</p>
<blockquote>
<div><p>Make the plot interactive.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">figure</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../index.html" class="btn btn-neutral" title="Latools Documentation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Oscar Branson.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>